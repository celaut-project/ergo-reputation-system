var er=Object.defineProperty;var tr=(e,t,n)=>t in e?er(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var p=(e,t,n)=>(tr(e,typeof t!="symbol"?t+"":t,n),n),Lt=(e,t,n)=>{if(!t.has(e))throw TypeError("Cannot "+n)};var C=(e,t,n)=>(Lt(e,t,"read from private field"),n?n.call(e):t.get(e)),fe=(e,t,n)=>{if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,n)},W=(e,t,n,r)=>(Lt(e,t,"write to private field"),r?r.call(e,n):t.set(e,n),n);var we=(e,t,n,r)=>({set _(s){W(e,t,s,n)},get _(){return C(e,t,r)}});import{s as pn,f as _n,n as Rt,r as mn,o as nr,h as rr,b as wn,i as sr}from"../chunks/scheduler.c805c319.js";import{S as yn,i as bn,g as E,s as D,h as T,j as K,y as J,c as V,f as x,k,z as ee,a as X,x as y,A as et,B as Z,C as ir,D as or,E as tt,m as vn,n as En,F as ar,o as lr,G as Mt,e as zt,d as qe,t as mt,b as ur,H as cr,r as hr,u as dr,v as fr,w as gr,p as pr}from"../chunks/index.deb0b7e6.js";function Nt(e){return(e==null?void 0:e.length)!==void 0?e:Array.from(e)}async function _r(e,t,n){try{const r=await fetch(e+"/api/v1/boxes/unspent/search",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({ergoTreeTemplateHash:t,registers:{R4:await n.get_change_address()}})});if(r.ok){const s=await r.json();return console.log(s),s.items.map(i=>({box_id:i.id,token_id:"",metadata:i}))}else return console.error("Error al realizar la solicitud POST"),[]}catch(r){return console.error("Error al procesar la solicitud POST:",r),[]}}function oe(e,t){if(e)return;let n;switch(typeof t){case"string":n=new Error(t);break;case"function":n=new Error(t());break;default:n=t}throw n}function Tn(e,t){const n=typeof e;if(n!==t)throw new Error(`Expected an object of type '${t}', got '${n}'.`)}var mr=e=>Object.prototype.toString.call(e);function wr(e){if(e===null)return"null";const t=typeof e;return t==="object"||t==="function"?mr(e).slice(8,-1):t}function It(e,t){if(!(e instanceof t))throw new Error(`Expected an instance of '${t.name}', got '${wr(e)}'.`)}function te(e){return e?Array.isArray(e)?e.length===0:Object.keys(e).length===0:!0}function $(e){return!te(e)}function F(e){return e==null||Number.isNaN(e)}function A(e){return!F(e)}function _e(e){if(e)return oe(e.length>0,"Empty array."),e[0]}function yr(e){if(e)return oe(e.length>0,"Empty array."),br(e,-1)}function br(e,t){const n=e==null?void 0:e.length;if(n)return t<0&&(t+=n),e[t]}function vr(e,t){return e.some((n,r)=>e.findIndex(s=>t(s)===t(n))!==r)}function Er(e,t){if(e.length<=t)return[e];const n=[];for(let r=0;r<e.length;r+=t)n.push(e.slice(r,r+t));return n}function Tr(e,t,n="asc"){return[...e].sort((r,s)=>t(r)>t(s)?n==="asc"?1:-1:t(r)<t(s)?n==="asc"?-1:1:0)}function Ir(e,t){if(e===t)return!0;if(e.length!=t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function Ut(e,t){if(e===t)return!0;if(t.length>e.length)return!1;for(let n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0}function kr(e,t){if(e===t)return!0;if(t.length>e.length)return!1;const n=e.length-t.length;for(let r=t.length-1;r>=0;r--)if(t[r]!==e[r+n])return!1;return!0}var I=BigInt(0),nt=BigInt(1),In=BigInt(7);BigInt(10);var xr=BigInt(63),kn=BigInt(127),xn=BigInt(128);function R(e){return typeof e=="bigint"?e:BigInt(e)}function wt(e,t,n){let r=I;if(te(e))return r;for(const s of e)(F(n)||n(s))&&(r+=t(s));return r}var Te="nanoErgs";function ce(e,t){const n={};for(const r of e)if((F(t)||t===Te)&&(n[Te]=(n[Te]||I)+R(r.value)),t!==Te)for(const s of r.assets)A(t)&&t!==s.tokenId||(n[s.tokenId]=(n[s.tokenId]||I)+R(s.amount));return A(t)?n[t]||I:{nanoErgs:n[Te]||I,tokens:Object.keys(n).filter(r=>r!==Te).map(r=>({tokenId:r,amount:n[r]}))}}function We(e,t){var s;Array.isArray(e)&&(e=ce(e)),Array.isArray(t)&&(t=ce(t));const n=[],r=e.nanoErgs-t.nanoErgs;for(const i of e.tokens){const o=i.amount-(((s=t.tokens.find(a=>a.tokenId===i.tokenId))==null?void 0:s.amount)||I);o!==I&&n.push({tokenId:i.tokenId,amount:o})}return{nanoErgs:r,tokens:n}}var Dt=4,Br=9;function Ar(e){let t=0;for(let n=Dt;n<=Br;n++){const r=`R${n}`;if(e[r]){if(n===Dt){t=n;continue}if(n-t>1)return!1;t=n}}return!0}function Cr(e){const t={};for(const n in e){const r=e[n];F(r)||(t[n]=r)}return t}function Qe(...e){const t=new Uint8Array(e.reduce((r,s)=>r+s.length,0));let n=0;for(const r of e)It(r,Uint8Array),t.set(r,n),n+=r.length;return t}function Bn(e){return!e||e.length%2?!1:(e.startsWith("0x")||(e="0x"+e),!isNaN(Number(e)))}function He(e){return e.length/2}var ot=(e=>(e[e.Mainnet=0]="Mainnet",e[e.Testnet=16]="Testnet",e))(ot||{}),Y=(e=>(e[e.P2PK=1]="P2PK",e[e.P2SH=2]="P2SH",e[e.P2S=3]="P2S",e))(Y||{}),Vt={sizeInclusion:8,constantSegregation:16},kt=class{constructor(){p(this,"_items");this._items=[]}_isIndexOutOfBounds(e){return e<0||e>=this._items.length}[Symbol.iterator](){let e=0;return{next:()=>({done:e>=this.length,value:this._items[e++]})}}get length(){return this._items.length}get isEmpty(){return this.length===0}at(e){if(this._isIndexOutOfBounds(e))throw new RangeError(`Index '${e}' is out of range.`);return this._items[e]}add(e,t){return this._addOneOrMore(e,t)}_addOne(e,t){if(A(t)&&A(t.index)){if(t.index===this.length)return this._items.push(this._map(e)),this.length;if(this._isIndexOutOfBounds(t.index))throw new RangeError(`Index '${t.index}' is out of range.`);return this._items.splice(t.index,0,this._map(e)),this.length}return this._items.push(this._map(e)),this._items.length}_addOneOrMore(e,t){if(Array.isArray(e)){A(t)&&A(t.index)&&(e=e.reverse());for(const n of e)this._addOne(n,t)}else this._addOne(e,t);return this.length}toArray(){return[...this._items]}reduce(e,t){return this._items.reduce(e,t)}};/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */const Sr=e=>e instanceof Uint8Array,rt=e=>new Uint32Array(e.buffer,e.byteOffset,Math.floor(e.byteLength/4)),Or=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;if(!Or)throw new Error("Non little-endian hardware is not supported");function Pr(e){if(typeof e!="string")throw new Error(`utf8ToBytes expected string, got ${typeof e}`);return new Uint8Array(new TextEncoder().encode(e))}function Le(e){if(typeof e=="string"&&(e=Pr(e)),!Sr(e))throw new Error(`expected Uint8Array, got ${typeof e}`);return e}class Hr{clone(){return this._cloneInto()}}function Lr(e){const t=(r,s)=>e(s).update(Le(r)).digest(),n=e({});return t.outputLen=n.outputLen,t.blockLen=n.blockLen,t.create=r=>e(r),t}function ht(e){if(!Number.isSafeInteger(e)||e<0)throw new Error(`Wrong positive integer: ${e}`)}function Rr(e,...t){if(!(e instanceof Uint8Array))throw new Error("Expected Uint8Array");if(t.length>0&&!t.includes(e.length))throw new Error(`Expected Uint8Array of length ${t}, not of length=${e.length}`)}function $t(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function Mr(e,t){Rr(e);const n=t.outputLen;if(e.length<n)throw new Error(`digestInto() expects output buffer of length at least ${n}`)}const zr=new Uint8Array([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9,12,5,1,15,14,13,4,10,0,7,6,3,9,2,8,11,13,11,7,14,12,1,3,9,5,0,15,4,8,6,2,10,6,15,14,9,11,3,0,8,12,2,13,7,1,4,10,5,10,2,8,4,7,6,1,5,15,11,9,14,3,12,13,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3]);class Nr extends Hr{constructor(t,n,r={},s,i,o){if(super(),this.blockLen=t,this.outputLen=n,this.length=0,this.pos=0,this.finished=!1,this.destroyed=!1,ht(t),ht(n),ht(s),n<0||n>s)throw new Error("outputLen bigger than keyLen");if(r.key!==void 0&&(r.key.length<1||r.key.length>s))throw new Error(`key must be up 1..${s} byte long or undefined`);if(r.salt!==void 0&&r.salt.length!==i)throw new Error(`salt must be ${i} byte long or undefined`);if(r.personalization!==void 0&&r.personalization.length!==o)throw new Error(`personalization must be ${o} byte long or undefined`);this.buffer32=rt(this.buffer=new Uint8Array(t))}update(t){$t(this);const{blockLen:n,buffer:r,buffer32:s}=this;t=Le(t);const i=t.length,o=t.byteOffset,a=t.buffer;for(let l=0;l<i;){this.pos===n&&(this.compress(s,0,!1),this.pos=0);const c=Math.min(n-this.pos,i-l),g=o+l;if(c===n&&!(g%4)&&l+c<i){const u=new Uint32Array(a,g,Math.floor((i-l)/4));for(let f=0;l+n<i;f+=s.length,l+=n)this.length+=n,this.compress(u,f,!1);continue}r.set(t.subarray(l,l+c),this.pos),this.pos+=c,this.length+=c,l+=c}return this}digestInto(t){$t(this),Mr(t,this);const{pos:n,buffer32:r}=this;this.finished=!0,this.buffer.subarray(n).fill(0),this.compress(r,0,!0);const s=rt(t);this.get().forEach((i,o)=>s[o]=i)}digest(){const{buffer:t,outputLen:n}=this;this.digestInto(t);const r=t.slice(0,n);return this.destroy(),r}_cloneInto(t){const{buffer:n,length:r,finished:s,destroyed:i,outputLen:o,pos:a}=this;return t||(t=new this.constructor({dkLen:o})),t.set(...this.get()),t.length=r,t.finished=s,t.destroyed=i,t.outputLen=o,t.buffer.set(n),t.pos=a,t}}const Ke=BigInt(2**32-1),yt=BigInt(32);function An(e,t=!1){return t?{h:Number(e&Ke),l:Number(e>>yt&Ke)}:{h:Number(e>>yt&Ke)|0,l:Number(e&Ke)|0}}function Ur(e,t=!1){let n=new Uint32Array(e.length),r=new Uint32Array(e.length);for(let s=0;s<e.length;s++){const{h:i,l:o}=An(e[s],t);[n[s],r[s]]=[i,o]}return[n,r]}const Dr=(e,t)=>BigInt(e>>>0)<<yt|BigInt(t>>>0),Vr=(e,t,n)=>e>>>n,$r=(e,t,n)=>e<<32-n|t>>>n,jr=(e,t,n)=>e>>>n|t<<32-n,Fr=(e,t,n)=>e<<32-n|t>>>n,Gr=(e,t,n)=>e<<64-n|t>>>n-32,Qr=(e,t,n)=>e>>>n-32|t<<64-n,Kr=(e,t)=>t,Xr=(e,t)=>e,qr=(e,t,n)=>e<<n|t>>>32-n,Wr=(e,t,n)=>t<<n|e>>>32-n,Yr=(e,t,n)=>t<<n-32|e>>>64-n,Zr=(e,t,n)=>e<<n-32|t>>>64-n;function Jr(e,t,n,r){const s=(t>>>0)+(r>>>0);return{h:e+n+(s/2**32|0)|0,l:s|0}}const es=(e,t,n)=>(e>>>0)+(t>>>0)+(n>>>0),ts=(e,t,n,r)=>t+n+r+(e/2**32|0)|0,ns=(e,t,n,r)=>(e>>>0)+(t>>>0)+(n>>>0)+(r>>>0),rs=(e,t,n,r,s)=>t+n+r+s+(e/2**32|0)|0,ss=(e,t,n,r,s)=>(e>>>0)+(t>>>0)+(n>>>0)+(r>>>0)+(s>>>0),is=(e,t,n,r,s,i)=>t+n+r+s+i+(e/2**32|0)|0,os={fromBig:An,split:Ur,toBig:Dr,shrSH:Vr,shrSL:$r,rotrSH:jr,rotrSL:Fr,rotrBH:Gr,rotrBL:Qr,rotr32H:Kr,rotr32L:Xr,rotlSH:qr,rotlSL:Wr,rotlBH:Yr,rotlBL:Zr,add:Jr,add3L:es,add3H:ts,add4L:ns,add4H:rs,add5H:is,add5L:ss},Q=os,O=new Uint32Array([4089235720,1779033703,2227873595,3144134277,4271175723,1013904242,1595750129,2773480762,2917565137,1359893119,725511199,2600822924,4215389547,528734635,327033209,1541459225]),d=new Uint32Array(32);function ge(e,t,n,r,s,i){const o=s[i],a=s[i+1];let l=d[2*e],c=d[2*e+1],g=d[2*t],u=d[2*t+1],f=d[2*n],_=d[2*n+1],b=d[2*r],m=d[2*r+1],v=Q.add3L(l,g,o);c=Q.add3H(v,c,u,a),l=v|0,{Dh:m,Dl:b}={Dh:m^c,Dl:b^l},{Dh:m,Dl:b}={Dh:Q.rotr32H(m,b),Dl:Q.rotr32L(m,b)},{h:_,l:f}=Q.add(_,f,m,b),{Bh:u,Bl:g}={Bh:u^_,Bl:g^f},{Bh:u,Bl:g}={Bh:Q.rotrSH(u,g,24),Bl:Q.rotrSL(u,g,24)},d[2*e]=l,d[2*e+1]=c,d[2*t]=g,d[2*t+1]=u,d[2*n]=f,d[2*n+1]=_,d[2*r]=b,d[2*r+1]=m}function pe(e,t,n,r,s,i){const o=s[i],a=s[i+1];let l=d[2*e],c=d[2*e+1],g=d[2*t],u=d[2*t+1],f=d[2*n],_=d[2*n+1],b=d[2*r],m=d[2*r+1],v=Q.add3L(l,g,o);c=Q.add3H(v,c,u,a),l=v|0,{Dh:m,Dl:b}={Dh:m^c,Dl:b^l},{Dh:m,Dl:b}={Dh:Q.rotrSH(m,b,16),Dl:Q.rotrSL(m,b,16)},{h:_,l:f}=Q.add(_,f,m,b),{Bh:u,Bl:g}={Bh:u^_,Bl:g^f},{Bh:u,Bl:g}={Bh:Q.rotrBH(u,g,63),Bl:Q.rotrBL(u,g,63)},d[2*e]=l,d[2*e+1]=c,d[2*t]=g,d[2*t+1]=u,d[2*n]=f,d[2*n+1]=_,d[2*r]=b,d[2*r+1]=m}class as extends Nr{constructor(t={}){super(128,t.dkLen===void 0?64:t.dkLen,t,64,16,16),this.v0l=O[0]|0,this.v0h=O[1]|0,this.v1l=O[2]|0,this.v1h=O[3]|0,this.v2l=O[4]|0,this.v2h=O[5]|0,this.v3l=O[6]|0,this.v3h=O[7]|0,this.v4l=O[8]|0,this.v4h=O[9]|0,this.v5l=O[10]|0,this.v5h=O[11]|0,this.v6l=O[12]|0,this.v6h=O[13]|0,this.v7l=O[14]|0,this.v7h=O[15]|0;const n=t.key?t.key.length:0;if(this.v0l^=this.outputLen|n<<8|65536|1<<24,t.salt){const r=rt(Le(t.salt));this.v4l^=r[0],this.v4h^=r[1],this.v5l^=r[2],this.v5h^=r[3]}if(t.personalization){const r=rt(Le(t.personalization));this.v6l^=r[0],this.v6h^=r[1],this.v7l^=r[2],this.v7h^=r[3]}if(t.key){const r=new Uint8Array(this.blockLen);r.set(Le(t.key)),this.update(r)}}get(){let{v0l:t,v0h:n,v1l:r,v1h:s,v2l:i,v2h:o,v3l:a,v3h:l,v4l:c,v4h:g,v5l:u,v5h:f,v6l:_,v6h:b,v7l:m,v7h:v}=this;return[t,n,r,s,i,o,a,l,c,g,u,f,_,b,m,v]}set(t,n,r,s,i,o,a,l,c,g,u,f,_,b,m,v){this.v0l=t|0,this.v0h=n|0,this.v1l=r|0,this.v1h=s|0,this.v2l=i|0,this.v2h=o|0,this.v3l=a|0,this.v3h=l|0,this.v4l=c|0,this.v4h=g|0,this.v5l=u|0,this.v5h=f|0,this.v6l=_|0,this.v6h=b|0,this.v7l=m|0,this.v7h=v|0}compress(t,n,r){this.get().forEach((l,c)=>d[c]=l),d.set(O,16);let{h:s,l:i}=Q.fromBig(BigInt(this.length));d[24]=O[8]^i,d[25]=O[9]^s,r&&(d[28]=~d[28],d[29]=~d[29]);let o=0;const a=zr;for(let l=0;l<12;l++)ge(0,4,8,12,t,n+2*a[o++]),pe(0,4,8,12,t,n+2*a[o++]),ge(1,5,9,13,t,n+2*a[o++]),pe(1,5,9,13,t,n+2*a[o++]),ge(2,6,10,14,t,n+2*a[o++]),pe(2,6,10,14,t,n+2*a[o++]),ge(3,7,11,15,t,n+2*a[o++]),pe(3,7,11,15,t,n+2*a[o++]),ge(0,5,10,15,t,n+2*a[o++]),pe(0,5,10,15,t,n+2*a[o++]),ge(1,6,11,12,t,n+2*a[o++]),pe(1,6,11,12,t,n+2*a[o++]),ge(2,7,8,13,t,n+2*a[o++]),pe(2,7,8,13,t,n+2*a[o++]),ge(3,4,9,14,t,n+2*a[o++]),pe(3,4,9,14,t,n+2*a[o++]);this.v0l^=d[0]^d[16],this.v0h^=d[1]^d[17],this.v1l^=d[2]^d[18],this.v1h^=d[3]^d[19],this.v2l^=d[4]^d[20],this.v2h^=d[5]^d[21],this.v3l^=d[6]^d[22],this.v3h^=d[7]^d[23],this.v4l^=d[8]^d[24],this.v4h^=d[9]^d[25],this.v5l^=d[10]^d[26],this.v5h^=d[11]^d[27],this.v6l^=d[12]^d[28],this.v6h^=d[13]^d[29],this.v7l^=d[14]^d[30],this.v7h^=d[15]^d[31],d.fill(0)}destroy(){this.destroyed=!0,this.buffer32.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}const ls=Lr(e=>new as(e));/*! scure-base - MIT License (c) 2022 Paul Miller (paulmillr.com) */function Be(...e){const t=(s,i)=>o=>s(i(o)),n=Array.from(e).reverse().reduce((s,i)=>s?t(s,i.encode):i.encode,void 0),r=e.reduce((s,i)=>s?t(s,i.decode):i.decode,void 0);return{encode:n,decode:r}}function Ae(e){return{encode:t=>{if(!Array.isArray(t)||t.length&&typeof t[0]!="number")throw new Error("alphabet.encode input should be an array of numbers");return t.map(n=>{if(n<0||n>=e.length)throw new Error(`Digit index outside alphabet: ${n} (alphabet: ${e.length})`);return e[n]})},decode:t=>{if(!Array.isArray(t)||t.length&&typeof t[0]!="string")throw new Error("alphabet.decode input should be array of strings");return t.map(n=>{if(typeof n!="string")throw new Error(`alphabet.decode: not string element=${n}`);const r=e.indexOf(n);if(r===-1)throw new Error(`Unknown letter: "${n}". Allowed: ${e}`);return r})}}}function Ce(e=""){if(typeof e!="string")throw new Error("join separator should be string");return{encode:t=>{if(!Array.isArray(t)||t.length&&typeof t[0]!="string")throw new Error("join.encode input should be array of strings");for(let n of t)if(typeof n!="string")throw new Error(`join.encode: non-string input=${n}`);return t.join(e)},decode:t=>{if(typeof t!="string")throw new Error("join.decode input should be string");return t.split(e)}}}function xt(e,t="="){if(typeof t!="string")throw new Error("padding chr should be string");return{encode(n){if(!Array.isArray(n)||n.length&&typeof n[0]!="string")throw new Error("padding.encode input should be array of strings");for(let r of n)if(typeof r!="string")throw new Error(`padding.encode: non-string input=${r}`);for(;n.length*e%8;)n.push(t);return n},decode(n){if(!Array.isArray(n)||n.length&&typeof n[0]!="string")throw new Error("padding.encode input should be array of strings");for(let s of n)if(typeof s!="string")throw new Error(`padding.decode: non-string input=${s}`);let r=n.length;if(r*e%8)throw new Error("Invalid padding: string should have whole number of bytes");for(;r>0&&n[r-1]===t;r--)if(!((r-1)*e%8))throw new Error("Invalid padding: string has too much padding");return n.slice(0,r)}}}function us(e){if(typeof e!="function")throw new Error("normalize fn should be function");return{encode:t=>t,decode:t=>e(t)}}function jt(e,t,n){if(t<2)throw new Error(`convertRadix: wrong from=${t}, base cannot be less than 2`);if(n<2)throw new Error(`convertRadix: wrong to=${n}, base cannot be less than 2`);if(!Array.isArray(e))throw new Error("convertRadix: data should be array");if(!e.length)return[];let r=0;const s=[],i=Array.from(e);for(i.forEach(o=>{if(o<0||o>=t)throw new Error(`Wrong integer: ${o}`)});;){let o=0,a=!0;for(let l=r;l<i.length;l++){const c=i[l],g=t*o+c;if(!Number.isSafeInteger(g)||t*o/t!==o||g-c!==t*o)throw new Error("convertRadix: carry overflow");o=g%n;const u=Math.floor(g/n);if(i[l]=u,!Number.isSafeInteger(u)||u*n+o!==g)throw new Error("convertRadix: carry overflow");if(a)u?a=!1:r=l;else continue}if(s.push(o),a)break}for(let o=0;o<e.length-1&&e[o]===0;o++)s.push(0);return s.reverse()}const Cn=(e,t)=>t?Cn(t,e%t):e,st=(e,t)=>e+(t-Cn(e,t));function Ft(e,t,n,r){if(!Array.isArray(e))throw new Error("convertRadix2: data should be array");if(t<=0||t>32)throw new Error(`convertRadix2: wrong from=${t}`);if(n<=0||n>32)throw new Error(`convertRadix2: wrong to=${n}`);if(st(t,n)>32)throw new Error(`convertRadix2: carry overflow from=${t} to=${n} carryBits=${st(t,n)}`);let s=0,i=0;const o=2**n-1,a=[];for(const l of e){if(l>=2**t)throw new Error(`convertRadix2: invalid data word=${l} from=${t}`);if(s=s<<t|l,i+t>32)throw new Error(`convertRadix2: carry overflow pos=${i} from=${t}`);for(i+=t;i>=n;i-=n)a.push((s>>i-n&o)>>>0);s&=2**i-1}if(s=s<<n-i&o,!r&&i>=t)throw new Error("Excess padding");if(!r&&s)throw new Error(`Non-zero padding: ${s}`);return r&&i>0&&a.push(s>>>0),a}function cs(e){return{encode:t=>{if(!(t instanceof Uint8Array))throw new Error("radix.encode input should be Uint8Array");return jt(Array.from(t),2**8,e)},decode:t=>{if(!Array.isArray(t)||t.length&&typeof t[0]!="number")throw new Error("radix.decode input should be array of strings");return Uint8Array.from(jt(t,e,2**8))}}}function $e(e,t=!1){if(e<=0||e>32)throw new Error("radix2: bits should be in (0..32]");if(st(8,e)>32||st(e,8)>32)throw new Error("radix2: carry overflow");return{encode:n=>{if(!(n instanceof Uint8Array))throw new Error("radix2.encode input should be Uint8Array");return Ft(Array.from(n),8,e,!t)},decode:n=>{if(!Array.isArray(n)||n.length&&typeof n[0]!="number")throw new Error("radix2.decode input should be array of strings");return Uint8Array.from(Ft(n,e,8,t))}}}const hs=Be($e(4),Ae("0123456789ABCDEF"),Ce("")),ds=Be($e(5),Ae("ABCDEFGHIJKLMNOPQRSTUVWXYZ234567"),xt(5),Ce("")),fs=Be($e(6),Ae("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"),xt(6),Ce("")),gs=Be($e(6),Ae("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"),xt(6),Ce("")),ps=e=>Be(cs(58),Ae(e),Ce("")),it=ps("123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"),Gt=[0,2,3,5,6,7,9,10,11],_s={encode(e){let t="";for(let n=0;n<e.length;n+=8){const r=e.subarray(n,n+8);t+=it.encode(r).padStart(Gt[r.length],"1")}return t},decode(e){let t=[];for(let n=0;n<e.length;n+=11){const r=e.slice(n,n+11),s=Gt.indexOf(r.length),i=it.decode(r);for(let o=0;o<i.length-s;o++)if(i[o]!==0)throw new Error("base58xmr: wrong padding");t=t.concat(Array.from(i.slice(i.length-s)))}return Uint8Array.from(t)}},ms={encode:e=>new TextDecoder().decode(e),decode:e=>new TextEncoder().encode(e)},ws=Be($e(4),Ae("0123456789abcdef"),Ce(""),us(e=>{if(typeof e!="string"||e.length%2)throw new TypeError(`hex.decode: expected string, got ${typeof e} with length ${e.length}`);return e.toLowerCase()})),Qt={utf8:ms,hex:ws,base16:hs,base32:ds,base64:fs,base64url:gs,base58:it,base58xmr:_s},ys="Invalid encoding type. Available types: utf8, hex, base16, base32, base64, base64url, base58, base58xmr",dt=(e,t)=>{if(!Qt.hasOwnProperty(e))throw new TypeError(ys);if(typeof t!="string")throw new TypeError("stringToBytes() expects string");return Qt[e].decode(t)};var bs=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function vs(e){It(e,Uint8Array);let t="";for(let n=0,r=e.length;n<r;n++)t+=bs[e[n]];return t}function Es(e){Tn(e,"string"),oe(e.length%2===0,"Invalid hex padding.");const t=new Uint8Array(e.length/2);for(let n=0,r=0,s=t.length;n<s;n++){const i=Kt(e.charCodeAt(r++)),o=Kt(e.charCodeAt(r++));t[n]=i*16+o}return t}function Kt(e){if(e>=48&&e<=57)return e-48;if(e>=65&&e<=70)return e-(65-10);if(e>=97&&e<=102)return e-(97-10);throw new Error("Invalid byte sequence.")}var L={encode:vs,decode:Es};function Ts(e){return It(e,Uint8Array),new TextDecoder().decode(e)}function Is(e){return Tn(e,"string"),new Uint8Array(new TextEncoder().encode(e))}var ft={encode:Ts,decode:Is},Se=it;function ks(e){return e instanceof Uint8Array?e:L.decode(e)}function Re(e){return ls(ks(e),{dkLen:32})}function xs(e){e.length%2&&(e="0"+e);const t=BigInt("0x"+e);return 128&parseInt(e.slice(0,2),16)?-Sn(t):t}function Bs(e){const t=e>=I;t||(e=Sn(e));let n=e.toString(16);return n.length%2&&(n="0"+n),t&&128&parseInt(n.slice(0,2),16)&&(n="00"+n),n}function Sn(e){const t=e<I;t&&(e=-e);const n=e.toString(2);let r=n.length;const s=r%8;s>0?r+=8-s:t&&_e(n)==="1"&&n.indexOf("1",1)!==-1&&(r+=8);const i=(1n<<BigInt(r))-1n;return(~e&i)+1n}function As(e,t){if(t===0)return e.write(0);if(t<0)throw new RangeError("Variable Length Quantity not supported for negative numbers.");do{let n=t&127;t>>=7,t>0&&(n|=128),e.write(n)}while(t>0);return e}function gt(e){if(e.isEmpty)return 0;let t=0,n=0,r=0;do r=e.readByte(),t|=(r&127)<<n,n+=7;while(r&128);return t}function Cs(e,t){if(t===I)return e.write(0);if(t<I)throw new RangeError("Variable Length Quantity not supported for negative numbers");do{let n=Number(t&kn);t>>=In,t>0&&(n|=128),e.write(n)}while(t>0);return e}function Ss(e){if(e.isEmpty)return I;let t=I,n=I,r=I;do r=BigInt(e.readByte()),t|=(r&kn)<<n,n+=In;while((r&xn)!=I);return t}function G(e){let t=0;if(typeof e=="number"){do t++,e=Math.floor(e/128);while(e>0);return t}e=R(e);do t++,e/=xn;while(e>I);return t}function Os(e){return e<<1^e>>63}function Ps(e){return e>>1^-(e&1)}function Hs(e){return e<<nt^e>>xr}function Ls(e){return e>>nt^-(e&nt)}var le,ie,dn,Rs=(dn=class{constructor(e){fe(this,le,void 0);fe(this,ie,void 0);typeof e=="string"?W(this,le,L.decode(e)):W(this,le,e),W(this,ie,0)}get isEmpty(){return te(C(this,le))}readBoolean(){return this.readByte()===1}readBits(e){const t=new Array(e);let n=0;for(let r=0;r<e;r++){const s=C(this,le)[C(this,ie)]>>n++&1;t[r]=s===1,n==8&&(n=0,we(this,ie)._++)}return n>0&&we(this,ie)._++,t}readByte(){return C(this,le)[we(this,ie)._++]}readBytes(e){return C(this,le).subarray(C(this,ie),W(this,ie,C(this,ie)+e))}readVlq(){return gt(this)}readShort(){return Number(Ps(gt(this)))}readInt(){const e=this.readLong();return Number(e)}readLong(){return Ls(Ss(this))}readBigInt(){const e=gt(this);return xs(L.encode(this.readBytes(e)))}},le=new WeakMap,ie=new WeakMap,dn),ue,q,fn,Bt=(fn=class{constructor(e){fe(this,ue,void 0);fe(this,q,void 0);W(this,ue,new Uint8Array(e)),W(this,q,0)}get length(){return C(this,q)}writeBoolean(e){return this.write(e===!0?1:0),this}writeVLQ(e){return As(this,e)}writeBigVLQ(e){return Cs(this,e)}writeShort(e){return this.writeVLQ(Os(e)),this}writeInt(e){return this.writeLong(BigInt(e)),this}writeLong(e){return this.writeBigVLQ(Hs(e)),this}write(e){return C(this,ue)[we(this,q)._++]=e,this}writeBytes(e){return C(this,ue).set(e,C(this,q)),W(this,q,C(this,q)+e.length),this}writeHex(e){return this.writeBytes(L.decode(e))}writeBits(e){let t=0;for(let n=0;n<e.length;n++)e[n]?C(this,ue)[C(this,q)]|=1<<t++:C(this,ue)[C(this,q)]&=~(1<<t++),t==8&&(t=0,we(this,q)._++);return t>0&&we(this,q)._++,this}writeBigInt(e){const t=Bs(e);return this.writeVLQ(t.length/2),this.writeHex(t),this}toHex(){return L.encode(this.toBytes())}toBytes(){return C(this,ue).subarray(0,C(this,q))}},ue=new WeakMap,q=new WeakMap,fn),On=class{coerce(e){return e}},Pn=class extends On{get embeddable(){return!1}},me=class extends Pn{get embeddable(){return!0}},Ne,gn,Hn=(gn=class extends On{constructor(t){super();fe(this,Ne,void 0);W(this,Ne,t)}get elementsType(){return C(this,Ne)}get embeddable(){return!1}},Ne=new WeakMap,gn),Ln=class extends me{get code(){return 1}toString(){return"SBool"}},Rn=class extends me{get code(){return 2}toString(){return"SByte"}},Mn=class extends me{get code(){return 3}toString(){return"SShort"}},zn=class extends me{get code(){return 4}toString(){return"SInt"}},Nn=class extends me{get code(){return 5}coerce(e){return R(e)}toString(){return"SLong"}},Un=class extends me{get code(){return 6}coerce(e){return R(e)}toString(){return"SBigInt"}},Dn=class extends me{get code(){return 7}coerce(e){return typeof e=="string"?L.decode(e):e}toString(){return"SGroupElement"}},Vn=class extends me{get code(){return 8}toString(){return"SSigmaProp"}},$n=class extends Pn{get code(){return 98}toString(){return"SUnit"}},j=Object.freeze({embeddable:0,simpleColl:1,nestedColl:2,option:3,optionCollection:4,pairOne:5,pairTwo:6,symmetricPair:7,genericTuple:8}),jn=11,bt=jn+1,se=e=>bt*e,Ms=Object.freeze({code:se(j.simpleColl),embeddable:!1,simpleCollTypeCode:se(j.simpleColl),nestedCollTypeCode:se(j.nestedColl)}),zs=Object.freeze({code:se(j.pairOne),embeddable:!1,pairOneTypeCode:se(j.pairOne),pairTwoTypeCode:se(j.pairTwo),tripleTypeCode:se(j.pairTwo),symmetricPairTypeCode:se(j.symmetricPair),quadrupleTypeCode:se(j.symmetricPair),genericTupleTypeCode:se(j.genericTuple)}),h={bool:new Ln,byte:new Rn,short:new Mn,int:new zn,long:new Nn,bigInt:new Un,groupElement:new Dn,sigmaProp:new Vn,unit:new $n,coll:Ms,tuple:zs};function vt(e){return e.code>=h.coll.simpleCollTypeCode&&e.code<=h.coll.nestedCollTypeCode+jn}function Fn(e){return e.code>=h.tuple.pairOneTypeCode&&e.code<=h.tuple.genericTupleTypeCode}function ye(e){switch(e){case h.bool.code:return h.bool;case h.byte.code:return h.byte;case h.short.code:return h.short;case h.int.code:return h.int;case h.long.code:return h.long;case h.bigInt.code:return h.bigInt;case h.groupElement.code:return h.groupElement;case h.sigmaProp.code:return h.sigmaProp;default:throw new Error(`The type code '0x${e.toString(16)}' is not a valid primitive type code.`)}}var Ye=class extends Hn{get code(){return h.coll.code}coerce(e){return this.elementsType.code===h.byte.code&&!(e instanceof Uint8Array)?typeof e=="string"?L.decode(e):Uint8Array.from(e):e.map(t=>this.elementsType.coerce(t))}toString(){return`SColl[${this.elementsType.toString()}]`}},Oe=class extends Hn{get code(){return h.tuple.code}coerce(e){const t=new Array(e.length);for(let n=0;n<e.length;n++)t[n]=this.elementsType[n].coerce(e[n]);return t}toString(){return`(${this.elementsType.map(e=>e.toString()).join(", ")})`}};function he(e,t,n){return new Proxy(e,{apply:(r,s,i)=>{const o=t??new r;return!n&&te(i)?o:new Me(o,...i)}})}function Gn(e,t){return new Proxy(e,{apply:t})}var ke=he(Rn,h.byte);he(Ln,h.bool);he(Mn,h.short);he(zn,h.int);he(Nn,h.long);he(Un,h.bigInt);he(Dn,h.groupElement);he(Vn,h.sigmaProp);he($n,void 0,!0);var xe=Gn(Ye,(e,t,n)=>{const[r,s]=n,i=r();return s?new Me(new e(i),s):()=>new e(i)});Gn(Oe,(e,t,n)=>{const[r,s]=n;if(typeof r=="function"&&typeof s=="function")return()=>new e([r(),s()]);if(r instanceof Me&&s instanceof Me)return new Me(new e([r.type,s.type]),[r.data,s.data]);throw new Error("Invalid tuple declaration.")});var Ns=33,Xt=205,qt=class Ze{static serialize(t,n,r){if(n.embeddable)switch(n.code){case h.bool.code:return r.writeBoolean(t);case h.byte.code:return r.write(t);case h.short.code:return r.writeShort(t);case h.int.code:return r.writeInt(t);case h.long.code:return r.writeLong(t);case h.bigInt.code:return r.writeBigInt(t);case h.groupElement.code:return r.writeBytes(t);case h.sigmaProp.code:{const s=t;if(s.type===h.groupElement)return r.write(Xt),Ze.serialize(s.data,s.type,r);throw Error("Serialization error: SigmaProp operation not implemented.")}}else if(vt(n)){if(n.elementsType.code===h.byte.code){const s=t instanceof Uint8Array;oe(s,`SColl[Byte] expected an UInt8Array, got ${typeof t}.`)}else oe(Array.isArray(t),`SColl expected an array, got ${typeof t}.`);switch(r.writeVLQ(t.length),n.elementsType.code){case h.bool.code:return r.writeBits(t);case h.byte.code:return r.writeBytes(t);default:{for(let s=0;s<t.length;s++)Ze.serialize(t[s],n.elementsType,r);return r}}}else if(Fn(n)){oe(Array.isArray(t),`STupleType serialization expected an array, got ${typeof t}.`);const s=n.elementsType.length;for(let i=0;i<s;i++)Ze.serialize(t[i],n.elementsType[i],r);return r}else if(n.code===h.unit.code)return r;throw Error(`Serialization error: '0x${n.code.toString(16)}' type not implemented.`)}static deserialize(t,n){if(t.embeddable)switch(t.code){case h.bool.code:return n.readBoolean();case h.byte.code:return n.readByte();case h.short.code:return n.readShort();case h.int.code:return n.readInt();case h.long.code:return n.readLong();case h.bigInt.code:return n.readBigInt();case h.groupElement.code:return n.readBytes(Ns);case h.sigmaProp.code:{if(n.readByte()===Xt)return this.deserialize(h.groupElement,n);break}}else switch(t.code){case h.coll.code:{const r=n.readVlq(),s=t.elementsType;switch(s.code){case h.bool.code:return n.readBits(r);case h.byte.code:return n.readBytes(r);default:{const i=new Array(r);for(let o=0;o<r;o++)i[o]=this.deserialize(s,n);return i}}}case h.tuple.code:return t.elementsType.map(r=>this.deserialize(r,n));case h.unit.code:return}throw new Error(`Parsing error: '0x${t.code.toString(16)}' type not implemented.`)}},Wt=class{static serialize(e,t){if(e.embeddable)t.write(e.code);else if(e.code===h.unit.code)t.write(e.code);else if(vt(e))if(e.elementsType.embeddable)t.write(h.coll.simpleCollTypeCode+e.elementsType.code);else if(vt(e.elementsType)){const n=e.elementsType;n.elementsType.embeddable?t.write(h.coll.nestedCollTypeCode+n.elementsType.code):(t.write(h.coll.simpleCollTypeCode),this.serialize(n,t))}else t.write(h.coll.simpleCollTypeCode),this.serialize(e.elementsType,t);else if(Fn(e)){switch(e.elementsType.length){case 2:{const n=_e(e.elementsType),r=yr(e.elementsType);n.embeddable?n.code===r.code?t.write(h.tuple.symmetricPairTypeCode+n.code):(t.write(h.tuple.pairOneTypeCode+n.code),this.serialize(r,t)):r.embeddable?(t.write(h.tuple.pairTwoTypeCode+r.code),this.serialize(n,t)):(t.write(h.tuple.pairOneTypeCode),this.serialize(n,t),this.serialize(r,t));return}case 3:t.write(h.tuple.tripleTypeCode);break;case 4:t.write(h.tuple.quadrupleTypeCode);break;default:{const n=e.elementsType.length;oe(n>=2&&n<=255,"Invalid type: tuples must have between 2 and 255 items."),t.write(h.tuple.genericTupleTypeCode),t.writeVLQ(n)}}for(let n=0;n<e.elementsType.length;n++)this.serialize(e.elementsType[n],t)}else throw new Error("Serialization error: type not implemented.")}static deserialize(e){const t=e.readByte();if(oe(t>0,`Parsing Error: Unexpected type code '0x${t.toString(16)}'`),t<h.tuple.genericTupleTypeCode){const n=Math.floor(t/bt),r=Math.floor(t%bt);switch(n){case j.embeddable:return ye(r);case j.simpleColl:{const s=r===0?this.deserialize(e):ye(r);return new Ye(s)}case j.nestedColl:return new Ye(new Ye(ye(r)));case j.pairOne:{const s=r===0?[this.deserialize(e),this.deserialize(e)]:[ye(r),this.deserialize(e)];return new Oe(s)}case j.pairTwo:{const s=r===0?[this.deserialize(e),this.deserialize(e),this.deserialize(e)]:[this.deserialize(e),ye(r)];return new Oe(s)}case j.symmetricPair:{const s=r===0?[this.deserialize(e),this.deserialize(e),this.deserialize(e),this.deserialize(e)]:[ye(r),ye(r)];return new Oe(s)}}}else switch(t){case h.tuple.genericTupleTypeCode:{const n=e.readVlq(),r=new Array(n);for(let s=0;s<n;s++)r[s]=this.deserialize(e);return new Oe(r)}case h.unit.code:return h.unit}throw new Error("Not implemented.")}},Us=4096,Ue,De,Ve,Me=(Ve=class{constructor(t,n){fe(this,Ue,void 0);fe(this,De,void 0);W(this,Ue,t),W(this,De,t.coerce(n))}static from(t){oe(t.length>0,"Empty constant bytes.");const n=new Rs(t),r=Wt.deserialize(n),s=qt.deserialize(r,n);return new Ve(r,s)}get type(){return C(this,Ue)}get data(){return C(this,De)}toBytes(){const t=new Bt(Us);return Wt.serialize(this.type,t),qt.serialize(this.data,this.type,t),t.toBytes()}toHex(){return L.encode(this.toBytes())}},Ue=new WeakMap,De=new WeakMap,Ve),Ds=65535;function Qn(e,t,n){if(t||(t=new Bt(5e4)),t.writeBigVLQ(R(e.value)),t.writeHex(e.ergoTree),t.writeVLQ(e.creationHeight),Vs(t,e.assets,n),$s(t,e.additionalRegisters),A(n))return t;if(!Kn(e))throw new Error("Invalid box type.");return t.writeHex(e.transactionId).writeVLQ(e.index)}function Kn(e){const t=e;return A(t.transactionId)&&A(t.index)}function Vs(e,t,n){if(te(t)){e.write(0);return}e.writeVLQ(t.length),$(n)?t.map(r=>e.writeVLQ(n.indexOf(r.tokenId)).writeBigVLQ(R(r.amount))):t.map(r=>e.writeHex(r.tokenId).writeBigVLQ(R(r.amount)))}function $s(e,t){const n=Object.keys(t).sort();let r=0;for(const s of n)t[s]&&r++;if(e.writeVLQ(r),r!=0)for(const s of n){const i=t[s];A(i)&&e.writeHex(i)}}function js(e,t){if(F(e.creationHeight))throw new Error("Box size estimation error: creation height is undefined.");let n=0;n+=G(A(t)?t:e.value),n+=He(e.ergoTree),n+=G(e.creationHeight),n+=G(e.assets.length),n+=e.assets.reduce((s,i)=>s+=He(i.tokenId)+G(i.amount),0);let r=0;for(const s in e.additionalRegisters){const i=e.additionalRegisters[s];i&&(n+=He(i),r++)}return n+=G(r),n+=32,n+=G(Kn(e)?e.index:Ds),n}function Fs(e){const t=new Bt(1e5);t.writeVLQ(e.inputs.length),e.inputs.map(r=>Gs(t,r)),t.writeVLQ(e.dataInputs.length),e.dataInputs.map(r=>t.writeHex(r.boxId));const n=Ks(e.outputs);return t.writeVLQ(n.length),n.map(r=>t.writeHex(r)),t.writeVLQ(e.outputs.length),e.outputs.map(r=>Qn(r,t,n)),t}function Gs(e,t){e.writeHex(t.boxId),e.write(0),Qs(e,t.extension)}function Qs(e,t){const n=Object.keys(t);let r=0;for(const s of n){const i=t[s];A(i)&&r++}if(e.writeVLQ(r),r!=0)for(const s of n){const i=t[s];A(i)&&e.writeVLQ(Number(s)).writeHex(i)}}function Ks(e){const t=new Set;return e.flatMap(n=>n.assets.map(r=>t.add(r.tokenId))),Array.from(t)}var Xs=class extends Error{constructor(){super("One or more inputs was selected more than one time by the current selection strategy.")}},qs=class extends Error{constructor(t){const n=[];if(t.nanoErgs&&n.push(Yt("nanoErgs",t.nanoErgs)),$(t.tokens))for(const r of t.tokens)n.push(Yt(r.tokenId,r.amount));super(`Insufficient inputs:${n.join()}`);p(this,"unreached");this.unreached=t}};function Yt(e,t){return`
  > ${e}: ${t==null?void 0:t.toString()}`}var Ws=class{constructor(){p(this,"_inputs")}select(e,t){this._inputs=e;let n=[];$(t.tokens)&&(n=this._selectTokens(t.tokens));const r=wt(n,s=>s.value);if(F(t.nanoErgs)&&te(t.tokens)||A(t.nanoErgs)&&r<t.nanoErgs){const s=A(t.nanoErgs)?t.nanoErgs-r:void 0;n=n.concat(this._select(s))}return n}_selectTokens(e){let t=[];for(const n of e){const r=A(n.amount)?n.amount-ce(t,n.tokenId):void 0;r&&r<=I||(t=t.concat(this._select(r,n.tokenId)))}return t}_select(e,t){const n=this._inputs;let r=I,s=[];if(F(e))t?s=n.filter(i=>i.assets.some(o=>o.tokenId===t)):s=n;else for(let i=0;i<n.length&&r<e;i++)if(t)for(const o of n[i].assets)o.tokenId===t&&(r+=o.amount,s.push(n[i]));else r+=n[i].value,s.push(n[i]);return $(s)&&(this._inputs=this._inputs.filter(i=>!s.includes(i))),s}},Ys=class{constructor(e){p(this,"_selector");this._selector=e}select(e,t){return this._selector(e,t)}},Zs=class{constructor(e){p(this,"_inputs");p(this,"_strategy");p(this,"_ensureFilterPredicate");p(this,"_selector");p(this,"_sortDirection");p(this,"_ensureInclusionBoxIds");this._inputs=e}defineStrategy(e){return this._isISelectionStrategyImplementation(e)?this._strategy=e:this._strategy=new Ys(e),this}select(e){this._strategy||(this._strategy=new Ws);const t=this._deepCloneTarget(e);let n=[...this._inputs],r=[];const s=this._ensureFilterPredicate,i=this._ensureInclusionBoxIds;if(s?i?r=n.filter(a=>s(a)||i.has(a.boxId)):r=n.filter(s):i&&(r=n.filter(a=>i.has(a.boxId))),$(r)&&(n=n.filter(a=>!r.some(l=>l.boxId===a.boxId)),t.nanoErgs&&t.nanoErgs>I&&(t.nanoErgs-=wt(r,a=>a.value)),$(t.tokens)&&r.some(a=>!te(a.assets))))for(const a of t.tokens)a.amount&&a.amount>I&&(a.amount-=ce(r,a.tokenId));if(this._selector&&(n=Tr(n,this._selector,this._sortDirection||"asc")),r=r.concat(this._strategy.select(n,t)),vr(r,a=>a.boxId))throw new Xs;const o=this._getUnreachedTargets(r,e);if(o.nanoErgs||$(o.tokens))throw new qs(o);return r}_deepCloneTarget(e){return{nanoErgs:e.nanoErgs,tokens:e.tokens?e.tokens.map(t=>({tokenId:t.tokenId,amount:t.amount})):void 0}}_getUnreachedTargets(e,t){const n={nanoErgs:void 0,tokens:void 0},r=wt(e,s=>s.value);if(t.nanoErgs&&t.nanoErgs>r&&(n.nanoErgs=t.nanoErgs-r),te(t.tokens))return n;for(const s of t.tokens){const i=ce(e,s.tokenId);if(s.amount&&s.amount>i){if(s.tokenId===_e(e).boxId)continue;F(n.tokens)&&(n.tokens=[]),n.tokens.push({tokenId:s.tokenId,amount:s.amount-i})}}return n}ensureInclusion(e){if(typeof e=="function")this._ensureFilterPredicate=e;else if(e==="all")this._ensureFilterPredicate=t=>t.value>0n;else if(F(this._ensureInclusionBoxIds)&&(this._ensureInclusionBoxIds=new Set),Array.isArray(e))for(const t of e)this._ensureInclusionBoxIds.add(t);else this._ensureInclusionBoxIds.add(e);return this}orderBy(e,t){return this._selector=e,this._sortDirection=t,this}_isISelectionStrategyImplementation(e){return!!e.select}static buildTargetFrom(e){const t={};let n=I;for(const r of e){n+=R(r.value);for(const s of r.assets)t[s.tokenId]=(t[s.tokenId]||I)+R(s.amount)}return{nanoErgs:n,tokens:Object.keys(t).map(r=>({tokenId:r,amount:t[r]}))}}},Js=class extends Error{constructor(){super("Registers should be densely packed. This means that it's not possible to use a register like 'R7' without filling 'R6', 'R5' and 'R4', for example.")}},ei=class extends Error{constructor(){super("Minting context is undefined. Transaction's inputs must be included in order to determine minting token id.")}},ti=class extends Error{constructor(){super("Creation Height is undefined.")}},ni=class extends Error{constructor(e){super(`Invalid Ergo address: ${e}`)}},be=4,ri=32,Et=L.decode("0008cd"),si=36,Xn=L.decode("d40801"),Je=L.decode("00ea02d193b4cbe4e3010e040004300e18"),ii=44,Xe=24;function Zt(e){return _e(e)&240}function pt(e){return _e(e)&15}function Jt(e){return typeof e=="string"?L.decode(e):e}function oi(e){return e.length===si&&Ut(e,Et)?Y.P2PK:e.length===ii&&Ut(e,Je)&&kr(e,Xn)?Y.P2SH:Y.P2S}function en(e){return te(e)||e.length!==33?!1:e[0]===2||e[0]===3}var ze=class Ie{constructor(t,n){p(this,"_ergoTree");p(this,"_network");p(this,"_type");this._ergoTree=t,this._network=n,this._type=oi(t)}get network(){return this._network}get ergoTree(){return L.encode(this._ergoTree)}get type(){return this._type}static fromErgoTree(t,n){return new Ie(L.decode(t),n)}static fromPublicKey(t,n){const r=Jt(t);if(!en(r))throw new Error("The Public Key is invalid.");const s=Qe(Et,r);return new Ie(s,n)}static fromHash(t,n){if(t=Jt(t),t.length===ri)t=t.subarray(0,Xe);else if(t.length!=Xe)throw Error(`Invalid hash length: ${t.length}`);const r=Qe(Je,t,Xn);return new Ie(r,n)}static fromBase58(t,n=!1){const r=Se.decode(t);if(!n&&!Ie.validate(r))throw new ni(t);const s=Zt(r),i=pt(r),o=r.subarray(1,r.length-be);return i===Y.P2PK?this.fromPublicKey(o,s):i===Y.P2SH?this.fromHash(o,s):new Ie(o,s)}static validate(t){const n=typeof t=="string"?Se.decode(t):t;if(n.length<be)return!1;if(pt(n)===Y.P2PK){const a=n.subarray(1,n.length-be);if(!en(a))return!1}const r=n.subarray(0,n.length-be),s=n.subarray(n.length-be,n.length),o=Re(r).subarray(0,be);return Ir(o,s)}static getNetworkType(t){return Zt(Se.decode(t))}static getAddressType(t){return pt(Se.decode(t))}getPublicKeys(){return this.type===Y.P2PK?[this._ergoTree.subarray(Et.length)]:[]}toP2SH(t){if(this.type===Y.P2SH)return this.encode();const n=Re(this._ergoTree).subarray(0,Xe);return this._encode(n,Y.P2SH,t)}encode(t){let n;return this.type===Y.P2PK?n=_e(this.getPublicKeys()):this.type===Y.P2SH?n=this._ergoTree.subarray(Je.length,Je.length+Xe):n=this._ergoTree,this._encode(n,this.type,t)}_encode(t,n,r){A(r)||(A(this.network)?r=this.network:r=ot.Mainnet);const s=Uint8Array.from([r+n]);t=Qe(s,t);const i=Re(t).subarray(0,be);return Se.encode(Qe(t,i))}toString(t){return this.encode(t)}},ai=class qn{constructor(t){p(this,"boxId");p(this,"value");p(this,"ergoTree");p(this,"creationHeight");p(this,"assets");p(this,"additionalRegisters");p(this,"transactionId");p(this,"index");this.boxId=t.boxId,this.ergoTree=t.ergoTree,this.creationHeight=t.creationHeight,this.value=R(t.value),this.assets=t.assets.map(n=>({tokenId:n.tokenId,amount:R(n.amount)})),this.additionalRegisters=t.additionalRegisters,this.transactionId=t.transactionId,this.index=t.index}isValid(){return qn.validate(this)}static validate(t){const n=Qn(t).toBytes(),r=L.encode(Re(n));return t.boxId===r}},tn=class extends ai{constructor(t){super(t);p(this,"_extension");t.extension&&this.setContextVars(t.extension)}get extension(){return this._extension}setContextVars(t){return this._extension=t,this}toUnsignedInputObject(t){return{...this.toPlainObject(t),extension:this._extension||{}}}toPlainObject(t){return t==="EIP-12"?{boxId:this.boxId,value:this.value.toString(),ergoTree:this.ergoTree,creationHeight:this.creationHeight,assets:this.assets.map(n=>({tokenId:n.tokenId,amount:n.amount.toString()})),additionalRegisters:this.additionalRegisters,transactionId:this.transactionId,index:this.index}:{boxId:this.boxId}}},li=class{constructor(e,t,n){p(this,"_inputs");p(this,"_dataInputs");p(this,"_outputs");this._inputs=Object.freeze(e),this._dataInputs=Object.freeze(t),this._outputs=Object.freeze(n)}get id(){return L.encode(Re(this.toBytes()))}get inputs(){return this._inputs}get dataInputs(){return this._dataInputs}get outputs(){return this._outputs}get burning(){return We(ce(this.inputs),ce(this.outputs))}toPlainObject(e){return{inputs:this.inputs.map(t=>t.toUnsignedInputObject(e||"default")),dataInputs:this.dataInputs.map(t=>t.toPlainObject(e||"default")),outputs:this.outputs.map(t=>ui(t))}}toEIP12Object(){return this.toPlainObject("EIP-12")}toBytes(){return Fs({inputs:this.inputs.map(e=>e.toUnsignedInputObject("default")),dataInputs:this.dataInputs.map(e=>e.toPlainObject("default")),outputs:this.outputs}).toBytes()}};function ui(e){return{...e,value:e.value.toString(),assets:e.assets.map(t=>({tokenId:t.tokenId,amount:t.amount.toString()}))}}var ci=class extends Error{constructor(e){super(`Box '${e}' is already included.`)}},hi=class extends Error{constructor(e){super(e)}},di=class extends Error{constructor(e){super(`Invalid input: ${e}`)}},nn=class extends Error{constructor(e){super(`Malformed transaction: ${e}`)}},fi=class extends Error{constructor(){super(`A box must contain no more than ${Ct} distinct tokens.`)}},Wn=class extends Error{constructor(){super("This transaction is trying to burn tokens. If that's your intention you must explicitly allow token burning on TransactionBuilder.configure() method. If no, a change address should be provided.")}},At=class extends Error{constructor(e){super(e)}},Ct=120,Tt=class extends kt{constructor(e,t){super(),A(e)&&this.add(e,t)}_map(e){return{tokenId:e.tokenId,amount:R(e.amount)}}_addOne(e,t){if((F(t)||t.sum&&!A(t.index))&&this._sum(this._map(e)))return this.length;if(this._items.length>=Ct)throw new fi;return super._addOne(e,t),this.length}add(e,t){return super.add(e,t)}_sum(e){for(const t of this._items)if(t.tokenId===e.tokenId)return t.amount+=e.amount,!0;return!1}remove(e,t){let n=-1;if(typeof e=="number"){if(this._isIndexOutOfBounds(e))throw new RangeError(`Index '${e}' is out of range.`);n=e}else if(n=this._items.findIndex(r=>r.tokenId===e),this._isIndexOutOfBounds(n))throw new At(`TokenId '${e}' not found in assets collection.`);if(t&&n>-1){const r=R(t),s=this._items[n];if(r>s.amount)throw new hi("Insufficient token amount to perform a subtraction operation.");if(r<s.amount)return s.amount-=r,this.length}return this._items.splice(n,1),this.length}contains(e){return this._items.some(t=>t.tokenId===e)}},rn=class extends kt{constructor(e){super(),A(e)&&this.add(e)}_map(e){return e instanceof tn?e:new tn(e)}_addOne(e){if(this._items.some(t=>t.boxId===e.boxId))throw new ci(e.boxId);return super._addOne(e)}remove(e){let t=-1;if(typeof e=="number"){if(this._isIndexOutOfBounds(e))throw new RangeError(`Index '${e}' is out of range.`);t=e}else if(t=this._items.findIndex(n=>n.boxId===e),this._isIndexOutOfBounds(t))throw new At("The input you are trying to remove is not present in the inputs collection.");return this._items.splice(t,1),this.length}},gi=class Yn extends kt{constructor(t){super(),A(t)&&this.add(t)}_map(t){return t}remove(t){let n=-1;if(typeof t=="number"){if(this._isIndexOutOfBounds(t))throw new RangeError(`Index '${t}' is out of range.`);n=t}else if(n=this._items.lastIndexOf(t),this._isIndexOutOfBounds(n))throw new At("The output you are trying to remove is not present in the outputs collection.");return this._items.splice(n,1),this.length}clone(){return new Yn(this._items)}sum(t){const n={};let r=I;if(t&&(t.nanoErgs&&(r=t.nanoErgs),$(t.tokens)))for(const s of t.tokens)F(s.amount)||(n[s.tokenId]=(n[s.tokenId]||I)+s.amount);for(const s of this._items){r+=s.value;for(const i of s.assets)n[i.tokenId]=(n[i.tokenId]||I)+i.amount}return{nanoErgs:r,tokens:Object.keys(n).map(s=>({tokenId:s,amount:n[s]}))}}},pi=7,_i=class{constructor(e){p(this,"_bytes");typeof e=="string"?this._bytes=L.decode(e):this._bytes=e}get header(){return this._bytes[0]}get version(){return this.header&pi}get hasSegregatedConstants(){return(this.header&Vt.constantSegregation)!=0}get hasSize(){return(this.header&Vt.sizeInclusion)!=0}toBytes(){return this._bytes}toHex(){return L.encode(this.toBytes())}toAddress(e=ot.Mainnet){return ze.fromErgoTree(this.toHex(),e)}},Zn=BigInt(360),St=BigInt(1e6);function mi(e=Zn){return t=>BigInt(t.estimateSize())*e}var Pe=class{constructor(e,t,n){p(this,"_address");p(this,"_tokens");p(this,"_value");p(this,"_valueEstimator");p(this,"_creationHeight");p(this,"_registers");p(this,"_minting");this.setValue(e),this._creationHeight=n,this._tokens=new Tt,this._registers={},typeof t=="string"?this._address=Bn(t)?ze.fromErgoTree(t):ze.fromBase58(t):t instanceof _i?this._address=t.toAddress():this._address=t}get value(){return A(this._valueEstimator)?this._valueEstimator(this):this._value}get address(){return this._address}get ergoTree(){return this._address.ergoTree}get creationHeight(){return this._creationHeight}get assets(){return this._tokens}get additionalRegisters(){return this._registers}get minting(){return this._minting}setValue(e){if(typeof e=="function")this._valueEstimator=e;else if(this._value=R(e),this._valueEstimator=void 0,this._value<=I)throw new Error("An UTxO cannot be created without a minimum required amount.");return this}addTokens(e,t){return e instanceof Tt?this._tokens.add(e.toArray(),t):this._tokens.add(e,t),this}addNfts(...e){const t=e.map(n=>({tokenId:n,amount:nt}));return this.addTokens(t)}mintToken(e){return this._minting={...e,amount:R(e.amount)},this}setCreationHeight(e,t){return(F(t)||t.replace===!0||t.replace===!1&&F(this._creationHeight))&&(this._creationHeight=e),this}setAdditionalRegisters(e){if(this._registers=Cr(e),!Ar(e))throw new Js;return this}eject(e){return e({tokens:this._tokens}),this}build(e){var n;let t=this.assets.toArray();if(this.minting){if(te(e))throw new ti;te(this.additionalRegisters)&&this.setAdditionalRegisters({R4:xe(ke,ft.decode(this.minting.name||"")).toHex(),R5:xe(ke,ft.decode(this.minting.description||"")).toHex(),R6:xe(ke,ft.decode(((n=this.minting.decimals)==null?void 0:n.toString())||"0")).toHex()}),t=[{tokenId:_e(e).boxId,amount:this.minting.amount},...t]}if(F(this.creationHeight))throw new ei;return{value:this.value,ergoTree:this.ergoTree,creationHeight:this.creationHeight,assets:t.map(r=>({tokenId:r.tokenId,amount:r.amount})),additionalRegisters:this.additionalRegisters}}estimateSize(e=St){oe(!!this.creationHeight,"Creation height must be set");const t=this._tokens.toArray();this.minting&&t.push({tokenId:"0000000000000000000000000000000000000000000000000000000000000000",amount:this.minting.amount});const n={value:e,ergoTree:this.ergoTree,creationHeight:this.creationHeight,assets:t.map(r=>({tokenId:r.tokenId,amount:r.amount})),additionalRegisters:this.additionalRegisters};return js(n)}},wi=class extends Error{constructor(e){super(e)}};function yi(e){return{addInputs:t=>e.from(t).configureSelector(n=>n.ensureInclusion(Array.isArray(t)?t.map(r=>r.boxId):t.boxId)).inputs.length,addOutputs:(t,n)=>e.to(t,n).outputs.length,addDataInputs:(t,n)=>e.withDataFrom(t,n).dataInputs.length,burnTokens:t=>{if(!e.settings.canBurnTokensFromPlugins)throw new Wn;e.burnTokens(t)},setFee:t=>e.payFee(t)}}var bi=class{constructor(){p(this,"_maxDistinctTokensPerChangeBox");p(this,"_allowTokenBurning");p(this,"_allowTokenBurningFromPlugins");p(this,"_isolateErgOnChange");this._maxDistinctTokensPerChangeBox=Ct,this._allowTokenBurning=!1,this._allowTokenBurningFromPlugins=!1,this._isolateErgOnChange=!1}get maxTokensPerChangeBox(){return this._maxDistinctTokensPerChangeBox}get canBurnTokens(){return this._allowTokenBurning}get canBurnTokensFromPlugins(){return this.canBurnTokens||this._allowTokenBurningFromPlugins}get shouldIsolateErgOnChange(){return this._isolateErgOnChange}setMaxTokensPerChangeBox(e){return this._maxDistinctTokensPerChangeBox=e,this}allowTokenBurning(e=!0){return this._allowTokenBurning=e,this}allowTokenBurningFromPlugins(e=!0){return this._allowTokenBurningFromPlugins=e,this}isolateErgOnChange(e=!0){return this._isolateErgOnChange=e,this}},Jn=BigInt(11e5),vi="1005040004000e36100204a00b08cd0279be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798ea02d192a39a8cc7a701730073011001020402d19683030193a38cc7b2a57300000193c2b2a57301007473027303830108cdeeac93b1a57304",Ei=class{constructor(e){p(this,"_inputs");p(this,"_dataInputs");p(this,"_outputs");p(this,"_settings");p(this,"_creationHeight");p(this,"_selectorCallbacks");p(this,"_changeAddress");p(this,"_feeAmount");p(this,"_burning");p(this,"_plugins");this._inputs=new rn,this._dataInputs=new rn,this._outputs=new gi,this._settings=new bi,this._creationHeight=e}get inputs(){return this._inputs}get dataInputs(){return this._dataInputs}get outputs(){return this._outputs}get changeAddress(){return this._changeAddress}get fee(){return this._feeAmount}get burning(){return this._burning}get settings(){return this._settings}get creationHeight(){return this._creationHeight}get and(){return this}from(e){return Ti(e)&&(e=e.toArray()),this._inputs.add(e),this}to(e,t){return this._outputs.add(e,t),this}withDataFrom(e,t){return this._dataInputs.add(e,t),this}sendChangeTo(e){return typeof e=="string"?this._changeAddress=Bn(e)?ze.fromErgoTree(e,ot.Mainnet):ze.fromBase58(e):this._changeAddress=e,this}payFee(e){return this._feeAmount=R(e),this}payMinFee(){return this.payFee(Jn),this}burnTokens(e){return this._burning||(this._burning=new Tt),this._burning.add(e),this}configure(e){return e(this._settings),this}configureSelector(e){return F(this._selectorCallbacks)&&(this._selectorCallbacks=[]),this._selectorCallbacks.push(e),this}extend(e){return this._plugins||(this._plugins=[]),this._plugins.push({execute:e,pending:!0}),this}eject(e){return e({inputs:this.inputs,dataInputs:this.dataInputs,outputs:this.outputs,burning:this.burning,settings:this.settings,selection:t=>{this.configureSelector(t)}}),this}build(){if($(this._plugins)){const o=yi(this);for(const a of this._plugins)a.pending&&(a.execute(o),a.pending=!1)}if(this._isMinting()){if(this._isMoreThanOneTokenBeingMinted())throw new nn("only one token can be minted per transaction.");if(this._isTheSameTokenBeingMintedOutsideTheMintingBox())throw new wi("EIP-4 tokens cannot be minted from outside of the minting box.")}this.outputs.toArray().map(o=>o.setCreationHeight(this._creationHeight,{replace:!1}));const e=this.outputs.clone();A(this._feeAmount)&&e.add(new Pe(this._feeAmount,vi));const t=new Zs(this.inputs.toArray());if($(this._selectorCallbacks))for(const o of this._selectorCallbacks)o(t);const n=$(this._burning)?e.sum({tokens:this._burning.toArray()}):e.sum();let r=t.select(n);if(A(this._changeAddress)){let o=We(ce(r),n);const a=[];if($(o.tokens)){let l=sn({changeAddress:this._changeAddress,creationHeight:this._creationHeight,tokens:o.tokens,maxTokensPerBox:this.settings.maxTokensPerChangeBox,baseIndex:this.outputs.length+1});for(;l>o.nanoErgs;)r=t.select({nanoErgs:n.nanoErgs+l,tokens:n.tokens}),o=We(ce(r),n),l=sn({changeAddress:this._changeAddress,creationHeight:this._creationHeight,tokens:o.tokens,maxTokensPerBox:this.settings.maxTokensPerChangeBox,baseIndex:this.outputs.length+1});const c=Er(o.tokens,this._settings.maxTokensPerChangeBox);for(const g of c){const u=new Pe(mi(),this._changeAddress,this._creationHeight).addTokens(g);o.nanoErgs-=u.value,a.push(u)}}if(o.nanoErgs>I)if($(a)){if(this.settings.shouldIsolateErgOnChange)e.add(new Pe(o.nanoErgs,this._changeAddress));else{const l=_e(a);l.setValue(l.value+o.nanoErgs)}e.add(a)}else e.add(new Pe(o.nanoErgs,this._changeAddress))}for(const o of r)if(!o.isValid())throw new di(o.boxId);const s=new li(r,this.dataInputs.toArray(),e.toArray().map(o=>o.setCreationHeight(this._creationHeight,{replace:!1}).build(r)));let i=s.burning;if(i.nanoErgs>I)throw new nn("it's not possible to burn ERG.");if($(i.tokens)&&$(this._burning)&&(i=We(i,{nanoErgs:I,tokens:this._burning.toArray()})),!this._settings.canBurnTokens&&$(i.tokens))throw new Wn;return s}_isMinting(){for(const e of this._outputs)if(e.minting)return!0;return!1}_isMoreThanOneTokenBeingMinted(){let e=0;for(const t of this._outputs)if(A(t.minting)&&(e++,e>1))return!0;return!1}_isTheSameTokenBeingMintedOutsideTheMintingBox(){const e=this._getMintingTokenId();if(F(e))return!1;for(const t of this._outputs)if(t.assets.contains(e))return!0;return!1}_getMintingTokenId(){let e;for(const t of this._outputs)if(t.minting){e=t.minting.tokenId;break}return e}};function Ti(e){return e.toArray!==void 0}function sn(e){return BigInt(Ii(e))*Zn}function Ii({changeAddress:e,creationHeight:t,tokens:n,baseIndex:r,maxTokensPerBox:s}){const i=Math.ceil(n.length/s);let o=0;o+=G(St),o+=He(e.ergoTree),o+=G(t),o+=G(0),o+=32,o=o*i;for(let a=0;a<i;a++)o+=G(r+a);return o+=n.reduce((a,l)=>a+=He(l.tokenId)+G(l.amount),0),n.length>s?n.length%s>0?(o+=G(s)*Math.floor(n.length/s),o+=G(n.length%s)):o+=G(s)*i:o+=G(n.length),o}function _t(e){return e.toHex()}async function ki(e,t,n){let r=(t==null?void 0:t.token_id)??"--",s=t!==void 0?[t.box]:await ergo.get_utxos();const i=await ergo.get_change_address(),o=i+ergo.get_current_height().toString();console.log("new one ",t,` 
  token id `,r,"   token_amount",e,` 
 inputs `,s,` 
 object to assign `,n,`
 wallet public key -> `,i,`
 token label -> `,o);const a=new Pe(St,i);t===void 0?a.mintToken({amount:e,name:"rt-"+o,decimals:0,description:"Reputation token "+o+" of the wallet "+i}):a.addTokens({tokenId:r,amount:e},{sum:!1}),a.setAdditionalRegisters(n===void 0?{R4:_t(xe(ke,dt("utf8",i)))}:{R4:_t(xe(ke,dt("utf8",i))),R5:_t(xe(ke,dt("utf8",n)))});const l=await new Ei(await ergo.get_current_height()).from(s).to(a).sendChangeTo(i).payFee(Jn).build().toEIP12Object(),c=await ergo.sign_tx(l),g=await ergo.submit_tx(c);return console.log("transaction id -> ",g),g}const xi="https://api.ergoplatform.com",Bi="EC591AEB578B53D7CE8BB2A0BEAB3795D187A4030D9D4C25E062AC26236F0D16";function on(e,t,n){const r=e.slice();return r[19]=t[n],r}function an(e){let t,n,r='Token amount<span class="required">*</span>',s,i,o,a;return{c(){t=E("div"),n=E("label"),n.innerHTML=r,s=D(),i=E("input"),this.h()},l(l){t=T(l,"DIV",{class:!0});var c=K(t);n=T(c,"LABEL",{for:!0,class:!0,"data-svelte-h":!0}),J(n)!=="svelte-11094ei"&&(n.innerHTML=r),s=V(c),i=T(c,"INPUT",{type:!0,class:!0}),c.forEach(x),this.h()},h(){k(n,"for","reputationToken"),k(n,"class","form-label"),k(i,"type","number"),k(i,"class","form-control"),k(t,"class","mb-3")},m(l,c){X(l,t,c),y(t,n),y(t,s),y(t,i),ee(i,e[4]),o||(a=Z(i,"input",e[11]),o=!0)},p(l,c){c&16&&tt(i.value)!==l[4]&&ee(i,l[4])},d(l){l&&x(t),o=!1,a()}}}function ln(e){let t,n,r="Reputation proof",s,i,o,a,l,c,g='Token amount<span class="required">*</span>',u,f,_,b,m=Nt(e[6]),v=[];for(let w=0;w<m.length;w+=1)v[w]=un(on(e,m,w));return{c(){t=E("div"),n=E("label"),n.textContent=r,s=D(),i=E("select"),o=vn(`' +
						  `);for(let w=0;w<v.length;w+=1)v[w].c();a=D(),l=E("div"),c=E("label"),c.innerHTML=g,u=D(),f=E("input"),this.h()},l(w){t=T(w,"DIV",{class:!0});var P=K(t);n=T(P,"LABEL",{class:!0,"data-svelte-h":!0}),J(n)!=="svelte-jndwld"&&(n.textContent=r),s=V(P),i=T(P,"SELECT",{class:!0});var B=K(i);o=En(B,`' +
						  `);for(let ne=0;ne<v.length;ne+=1)v[ne].l(B);B.forEach(x),P.forEach(x),a=V(w),l=T(w,"DIV",{class:!0});var S=K(l);c=T(S,"LABEL",{for:!0,class:!0,"data-svelte-h":!0}),J(c)!=="svelte-11094ei"&&(c.innerHTML=g),u=V(S),f=T(S,"INPUT",{type:!0,class:!0,max:!0}),S.forEach(x),this.h()},h(){k(n,"class","form-label"),k(i,"class","form-select"),e[3]===void 0&&_n(()=>e[12].call(i)),k(t,"class","mb-3"),k(c,"for","reputationToken"),k(c,"class","form-label"),k(f,"type","number"),k(f,"class","form-control"),k(f,"max",e[8]),k(l,"class","mb-3")},m(w,P){X(w,t,P),y(t,n),y(t,s),y(t,i),y(i,o);for(let B=0;B<v.length;B+=1)v[B]&&v[B].m(i,null);et(i,e[3],!0),X(w,a,P),X(w,l,P),y(l,c),y(l,u),y(l,f),ee(f,e[4]),_||(b=[Z(i,"change",e[12]),Z(f,"input",e[13])],_=!0)},p(w,P){if(P&64){m=Nt(w[6]);let B;for(B=0;B<m.length;B+=1){const S=on(w,m,B);v[B]?v[B].p(S,P):(v[B]=un(S),v[B].c(),v[B].m(i,null))}for(;B<v.length;B+=1)v[B].d(1);v.length=m.length}P&72&&et(i,w[3]),P&16&&tt(f.value)!==w[4]&&ee(f,w[4])},d(w){w&&(x(t),x(a),x(l)),ar(v,w),_=!1,mn(b)}}}function un(e){let t,n=e[19].box_id+"",r,s;return{c(){t=E("option"),r=vn(n),this.h()},l(i){t=T(i,"OPTION",{});var o=K(t);r=En(o,n),o.forEach(x),this.h()},h(){t.__value=s=e[19],ee(t,t.__value)},m(i,o){X(i,t,o),y(t,r)},p(i,o){o&64&&n!==(n=i[19].box_id+"")&&lr(r,n),o&64&&s!==(s=i[19])&&(t.__value=s,ee(t,t.__value))},d(i){i&&x(t)}}}function cn(e){let t,n,r="Object to assign reputation",s,i,o,a;return{c(){t=E("div"),n=E("label"),n.textContent=r,s=D(),i=E("input"),this.h()},l(l){t=T(l,"DIV",{class:!0});var c=K(t);n=T(c,"LABEL",{for:!0,class:!0,"data-svelte-h":!0}),J(n)!=="svelte-8q1gpd"&&(n.textContent=r),s=V(c),i=T(c,"INPUT",{type:!0,class:!0}),c.forEach(x),this.h()},h(){k(n,"for","object_to_assign"),k(n,"class","form-label"),k(i,"type","text"),k(i,"class","form-control"),k(t,"class","mb-3")},m(l,c){X(l,t,c),y(t,n),y(t,s),y(t,i),ee(i,e[5]),o||(a=Z(i,"input",e[14]),o=!0)},p(l,c){c&32&&i.value!==l[5]&&ee(i,l[5])},d(l){l&&x(t),o=!1,a()}}}function Ai(e){let t,n,r,s="Generate new reputation proof",i,o,a,l,c,g,u="Choose an option",f,_,b,m,v="A new one",w,P="From another reputation prove",B,S,ne,H,at,lt,ut,ve,de,Ot="Generate proof",ct,Pt,M=e[2]==="new"&&an(e),z=e[2]==="another"&&ln(e),N=e[2]!==""&&cn(e);return{c(){t=E("dialog"),n=E("div"),r=E("h2"),r.textContent=s,i=D(),o=E("hr"),a=D(),l=E("form"),c=E("div"),g=E("label"),g.textContent=u,f=D(),_=E("select"),b=E("option"),m=E("option"),m.textContent=v,w=E("option"),w.textContent=P,B=D(),S=E("div"),M&&M.c(),ne=D(),z&&z.c(),H=D(),N&&N.c(),at=D(),lt=E("hr"),ut=D(),ve=E("div"),de=E("button"),de.textContent=Ot,this.h()},l(U){t=T(U,"DIALOG",{class:!0});var ae=K(t);n=T(ae,"DIV",{class:!0});var re=K(n);r=T(re,"H2",{class:!0,id:!0,"data-svelte-h":!0}),J(r)!=="svelte-dvmzlv"&&(r.textContent=s),i=V(re),o=T(re,"HR",{}),a=V(re),l=T(re,"FORM",{id:!0});var je=K(l);c=T(je,"DIV",{class:!0});var Fe=K(c);g=T(Fe,"LABEL",{class:!0,"data-svelte-h":!0}),J(g)!=="svelte-bl1561"&&(g.textContent=u),f=V(Fe),_=T(Fe,"SELECT",{class:!0});var Ge=K(_);b=T(Ge,"OPTION",{}),K(b).forEach(x),m=T(Ge,"OPTION",{"data-svelte-h":!0}),J(m)!=="svelte-11rr8kj"&&(m.textContent=v),w=T(Ge,"OPTION",{"data-svelte-h":!0}),J(w)!=="svelte-wg52qh"&&(w.textContent=P),Ge.forEach(x),Fe.forEach(x),B=V(je),S=T(je,"DIV",{});var Ee=K(S);M&&M.l(Ee),ne=V(Ee),z&&z.l(Ee),H=V(Ee),N&&N.l(Ee),Ee.forEach(x),je.forEach(x),at=V(re),lt=T(re,"HR",{}),ut=V(re),ve=T(re,"DIV",{class:!0});var Ht=K(ve);de=T(Ht,"BUTTON",{class:!0,"data-svelte-h":!0}),J(de)!=="svelte-10bttu2"&&(de.textContent=Ot),Ht.forEach(x),re.forEach(x),ae.forEach(x),this.h()},h(){k(r,"class","modal-title"),k(r,"id","generateReputationLabel"),k(g,"class","form-label"),b.__value="",ee(b,b.__value),m.__value="new",ee(m,m.__value),w.__value="another",ee(w,w.__value),k(_,"class","form-select"),e[2]===void 0&&_n(()=>e[10].call(_)),k(c,"class","mb-3"),k(l,"id","reputationForm"),k(de,"class","svelte-19dligb"),k(ve,"class","row"),k(n,"class","svelte-19dligb"),k(t,"class","svelte-19dligb")},m(U,ae){X(U,t,ae),y(t,n),y(n,r),y(n,i),y(n,o),y(n,a),y(n,l),y(l,c),y(c,g),y(c,f),y(c,_),y(_,b),y(_,m),y(_,w),et(_,e[2],!0),y(l,B),y(l,S),M&&M.m(S,null),y(S,ne),z&&z.m(S,null),y(S,H),N&&N.m(S,null),y(n,at),y(n,lt),y(n,ut),y(n,ve),y(ve,de),e[16](t),ct||(Pt=[Z(_,"change",e[10]),Z(_,"change",e[7]),Z(de,"click",e[15]),Z(n,"click",ir(e[9])),Z(t,"close",e[17]),Z(t,"click",or(e[18]))],ct=!0)},p(U,[ae]){ae&4&&et(_,U[2]),U[2]==="new"?M?M.p(U,ae):(M=an(U),M.c(),M.m(S,ne)):M&&(M.d(1),M=null),U[2]==="another"?z?z.p(U,ae):(z=ln(U),z.c(),z.m(S,H)):z&&(z.d(1),z=null),U[2]!==""?N?N.p(U,ae):(N=cn(U),N.c(),N.m(S,null)):N&&(N.d(1),N=null)},i:Rt,o:Rt,d(U){U&&x(t),M&&M.d(),z&&z.d(),N&&N.d(),e[16](null),ct=!1,mn(Pt)}}}function Ci(e,t,n){let{showModal:r}=t,s,i="";function o(H){n(2,i=H.target.value)}let a,l,c,g,u=[];nr(async()=>{try{const H=await _r(xi,Bi,ergo);n(6,u=H)}catch(H){console.error(H)}});function f(H){rr.call(this,e,H)}function _(){i=Mt(this),n(2,i)}function b(){l=tt(this.value),n(4,l)}function m(){a=Mt(this),n(3,a),n(6,u)}function v(){l=tt(this.value),n(4,l)}function w(){c=this.value,n(5,c)}const P=()=>ki(l,a,c);function B(H){wn[H?"unshift":"push"](()=>{s=H,n(1,s)})}const S=()=>n(0,r=!1),ne=()=>s.close();return e.$$set=H=>{"showModal"in H&&n(0,r=H.showModal)},e.$$.update=()=>{e.$$.dirty&3&&s&&r&&s.showModal()},[r,s,i,a,l,c,u,o,g,f,_,b,m,v,w,P,B,S,ne]}class Si extends yn{constructor(t){super(),bn(this,t,Ci,Ai,pn,{showModal:0})}}function hn(e){let t,n="Generate reputation proof",r,s,i,o,a,l;function c(u){e[4](u)}let g={};return e[0]!==void 0&&(g.showModal=e[0]),s=new Si({props:g}),wn.push(()=>cr(s,"showModal",c)),{c(){t=E("button"),t.textContent=n,r=D(),hr(s.$$.fragment)},l(u){t=T(u,"BUTTON",{"data-svelte-h":!0}),J(t)!=="svelte-179w2h4"&&(t.textContent=n),r=V(u),dr(s.$$.fragment,u)},m(u,f){X(u,t,f),X(u,r,f),fr(s,u,f),o=!0,a||(l=Z(t,"click",e[3]),a=!0)},p(u,f){const _={};!i&&f&1&&(i=!0,_.showModal=u[0],sr(()=>i=!1)),s.$set(_)},i(u){o||(qe(s.$$.fragment,u),o=!0)},o(u){mt(s.$$.fragment,u),o=!1},d(u){u&&(x(t),x(r)),gr(s,u),a=!1,l()}}}function Oi(e){let t,n="Welcome to the Reputation System Panel",r,s,i="Connect to Nautilus",o,a,l,c,g,u=e[1]&&hn(e);return{c(){t=E("h1"),t.textContent=n,r=D(),s=E("button"),s.textContent=i,o=D(),u&&u.c(),a=zt()},l(f){t=T(f,"H1",{"data-svelte-h":!0}),J(t)!=="svelte-1rnm7g8"&&(t.textContent=n),r=V(f),s=T(f,"BUTTON",{"data-svelte-h":!0}),J(s)!=="svelte-dso3br"&&(s.textContent=i),o=V(f),u&&u.l(f),a=zt()},m(f,_){X(f,t,_),X(f,r,_),X(f,s,_),X(f,o,_),u&&u.m(f,_),X(f,a,_),l=!0,c||(g=Z(s,"click",e[2]),c=!0)},p(f,[_]){f[1]?u?(u.p(f,_),_&2&&qe(u,1)):(u=hn(f),u.c(),qe(u,1),u.m(a.parentNode,a)):u&&(pr(),mt(u,1,1,()=>{u=null}),ur())},i(f){l||(qe(u),l=!0)},o(f){mt(u),l=!1},d(f){f&&(x(t),x(r),x(s),x(o),x(a)),u&&u.d(f),c=!1,g()}}}function Pi(e,t,n){let r=!1,s=!1;async function i(){if(ergoConnector){const l=ergoConnector.nautilus;l?(console.log("Nautilus Wallet is ready to use"),n(1,s=await l.connect()),console.log(s?"Connected!":"Not connected!")):console.log("Nautilus Wallet is not active")}else console.log("No wallet available")}const o=()=>n(0,r=!0);function a(l){r=l,n(0,r)}return[r,s,i,o,a]}class Mi extends yn{constructor(t){super(),bn(this,t,Pi,Oi,pn,{})}}export{Mi as component};
