var Gn=Object.defineProperty;var Qn=(e,t,n)=>t in e?Gn(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var m=(e,t,n)=>(Qn(e,typeof t!="symbol"?t+"":t,n),n),St=(e,t,n)=>{if(!t.has(e))throw TypeError("Cannot "+n)};var A=(e,t,n)=>(St(e,t,"read from private field"),n?n.call(e):t.get(e)),pe=(e,t,n)=>{if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,n)},q=(e,t,n,s)=>(St(e,t,"write to private field"),s?s.call(e,n):t.set(e,n),n);var xe=(e,t,n,s)=>({set _(r){q(e,t,r,n)},get _(){return A(e,t,s)}});import{s as sn,f as rn,n as Ht,r as on,h as Kn,b as an,i as Xn}from"../chunks/scheduler.c805c319.js";import{S as ln,i as un,g as w,s as M,h as v,j as G,y as Z,c as N,f as I,k as x,z as ie,a as K,x as y,A as st,B as Y,C as qn,D as Wn,E as rt,m as Yn,n as Zn,F as Ot,e as Pt,d as Ze,t as mt,b as Jn,G as es,r as ts,u as ns,v as ss,w as rs,p as is}from"../chunks/index.3d44af4f.js";function oe(e,t){if(e)return;let n;switch(typeof t){case"string":n=new Error(t);break;case"function":n=new Error(t());break;default:n=t}throw n}function cn(e,t){const n=typeof e;if(n!==t)throw new Error(`Expected an object of type '${t}', got '${n}'.`)}var os=e=>Object.prototype.toString.call(e);function as(e){if(e===null)return"null";const t=typeof e;return t==="object"||t==="function"?os(e).slice(8,-1):t}function xt(e,t){if(!(e instanceof t))throw new Error(`Expected an instance of '${t.name}', got '${as(e)}'.`)}function J(e){return e?Array.isArray(e)?e.length===0:Object.keys(e).length===0:!0}function z(e){return!J(e)}function V(e){return e==null||Number.isNaN(e)}function k(e){return!V(e)}function we(e){if(e)return oe(e.length>0,"Empty array."),e[0]}function ls(e){if(e)return oe(e.length>0,"Empty array."),us(e,-1)}function us(e,t){const n=e==null?void 0:e.length;if(n)return t<0&&(t+=n),e[t]}function cs(e,t){return e.some((n,s)=>e.findIndex(r=>t(r)===t(n))!==s)}function hs(e,t){if(e.length<=t)return[e];const n=[];for(let s=0;s<e.length;s+=t)n.push(e.slice(s,s+t));return n}function ds(e,t,n="asc"){return[...e].sort((s,r)=>t(s)>t(r)?n==="asc"?1:-1:t(s)<t(r)?n==="asc"?-1:1:0)}function fs(e,t){if(e===t)return!0;if(e.length!=t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function Lt(e,t){if(e===t)return!0;if(t.length>e.length)return!1;for(let n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0}function gs(e,t){if(e===t)return!0;if(t.length>e.length)return!1;const n=e.length-t.length;for(let s=t.length-1;s>=0;s--)if(t[s]!==e[s+n])return!1;return!0}var E=BigInt(0),it=BigInt(1),hn=BigInt(7);BigInt(10);var ps=BigInt(63),dn=BigInt(127),fn=BigInt(128);function O(e){return typeof e=="bigint"?e:BigInt(e)}function _t(e,t,n){let s=E;if(J(e))return s;for(const r of e)(V(n)||n(r))&&(s+=t(r));return s}var Se="nanoErgs";function he(e,t){const n={};for(const s of e)if((V(t)||t===Se)&&(n[Se]=(n[Se]||E)+O(s.value)),t!==Se)for(const r of s.assets)k(t)&&t!==r.tokenId||(n[r.tokenId]=(n[r.tokenId]||E)+O(r.amount));return k(t)?n[t]||E:{nanoErgs:n[Se]||E,tokens:Object.keys(n).filter(s=>s!==Se).map(s=>({tokenId:s,amount:n[s]}))}}function Je(e,t){var r;Array.isArray(e)&&(e=he(e)),Array.isArray(t)&&(t=he(t));const n=[],s=e.nanoErgs-t.nanoErgs;for(const i of e.tokens){const o=i.amount-(((r=t.tokens.find(a=>a.tokenId===i.tokenId))==null?void 0:r.amount)||E);o!==E&&n.push({tokenId:i.tokenId,amount:o})}return{nanoErgs:s,tokens:n}}var Ut=4,ms=9;function _s(e){let t=0;for(let n=Ut;n<=ms;n++){const s=`R${n}`;if(e[s]){if(n===Ut){t=n;continue}if(n-t>1)return!1;t=n}}return!0}function bs(e){const t={};for(const n in e){const s=e[n];V(s)||(t[n]=s)}return t}function qe(...e){const t=new Uint8Array(e.reduce((s,r)=>s+r.length,0));let n=0;for(const s of e)xt(s,Uint8Array),t.set(s,n),n+=s.length;return t}function gn(e){return!e||e.length%2?!1:(e.startsWith("0x")||(e="0x"+e),!isNaN(Number(e)))}function Me(e){return e.length/2}var lt=(e=>(e[e.Mainnet=0]="Mainnet",e[e.Testnet=16]="Testnet",e))(lt||{}),W=(e=>(e[e.P2PK=1]="P2PK",e[e.P2SH=2]="P2SH",e[e.P2S=3]="P2S",e))(W||{}),Rt={sizeInclusion:8,constantSegregation:16},Tt=class{constructor(){m(this,"_items");this._items=[]}_isIndexOutOfBounds(e){return e<0||e>=this._items.length}[Symbol.iterator](){let e=0;return{next:()=>({done:e>=this.length,value:this._items[e++]})}}get length(){return this._items.length}get isEmpty(){return this.length===0}at(e){if(this._isIndexOutOfBounds(e))throw new RangeError(`Index '${e}' is out of range.`);return this._items[e]}add(e,t){return this._addOneOrMore(e,t)}_addOne(e,t){if(k(t)&&k(t.index)){if(t.index===this.length)return this._items.push(this._map(e)),this.length;if(this._isIndexOutOfBounds(t.index))throw new RangeError(`Index '${t.index}' is out of range.`);return this._items.splice(t.index,0,this._map(e)),this.length}return this._items.push(this._map(e)),this._items.length}_addOneOrMore(e,t){if(Array.isArray(e)){k(t)&&k(t.index)&&(e=e.reverse());for(const n of e)this._addOne(n,t)}else this._addOne(e,t);return this.length}toArray(){return[...this._items]}reduce(e,t){return this._items.reduce(e,t)}};/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */const ys=e=>e instanceof Uint8Array,ot=e=>new Uint32Array(e.buffer,e.byteOffset,Math.floor(e.byteLength/4)),ut=e=>new DataView(e.buffer,e.byteOffset,e.byteLength),ne=(e,t)=>e<<32-t|e>>>t,ws=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;if(!ws)throw new Error("Non little-endian hardware is not supported");function vs(e){if(typeof e!="string")throw new Error(`utf8ToBytes expected string, got ${typeof e}`);return new Uint8Array(new TextEncoder().encode(e))}function ke(e){if(typeof e=="string"&&(e=vs(e)),!ys(e))throw new Error(`expected Uint8Array, got ${typeof e}`);return e}class pn{clone(){return this._cloneInto()}}function Es(e){const t=s=>e().update(ke(s)).digest(),n=e();return t.outputLen=n.outputLen,t.blockLen=n.blockLen,t.create=()=>e(),t}function xs(e){const t=(s,r)=>e(r).update(ke(s)).digest(),n=e({});return t.outputLen=n.outputLen,t.blockLen=n.blockLen,t.create=s=>e(s),t}function ct(e){if(!Number.isSafeInteger(e)||e<0)throw new Error(`Wrong positive integer: ${e}`)}function Ts(e,...t){if(!(e instanceof Uint8Array))throw new Error("Expected Uint8Array");if(t.length>0&&!t.includes(e.length))throw new Error(`Expected Uint8Array of length ${t}, not of length=${e.length}`)}function at(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function mn(e,t){Ts(e);const n=t.outputLen;if(e.length<n)throw new Error(`digestInto() expects output buffer of length at least ${n}`)}const Is=new Uint8Array([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9,12,5,1,15,14,13,4,10,0,7,6,3,9,2,8,11,13,11,7,14,12,1,3,9,5,0,15,4,8,6,2,10,6,15,14,9,11,3,0,8,12,2,13,7,1,4,10,5,10,2,8,4,7,6,1,5,15,11,9,14,3,12,13,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3]);class ks extends pn{constructor(t,n,s={},r,i,o){if(super(),this.blockLen=t,this.outputLen=n,this.length=0,this.pos=0,this.finished=!1,this.destroyed=!1,ct(t),ct(n),ct(r),n<0||n>r)throw new Error("outputLen bigger than keyLen");if(s.key!==void 0&&(s.key.length<1||s.key.length>r))throw new Error(`key must be up 1..${r} byte long or undefined`);if(s.salt!==void 0&&s.salt.length!==i)throw new Error(`salt must be ${i} byte long or undefined`);if(s.personalization!==void 0&&s.personalization.length!==o)throw new Error(`personalization must be ${o} byte long or undefined`);this.buffer32=ot(this.buffer=new Uint8Array(t))}update(t){at(this);const{blockLen:n,buffer:s,buffer32:r}=this;t=ke(t);const i=t.length,o=t.byteOffset,a=t.buffer;for(let l=0;l<i;){this.pos===n&&(this.compress(r,0,!1),this.pos=0);const c=Math.min(n-this.pos,i-l),f=o+l;if(c===n&&!(f%4)&&l+c<i){const u=new Uint32Array(a,f,Math.floor((i-l)/4));for(let g=0;l+n<i;g+=r.length,l+=n)this.length+=n,this.compress(u,g,!1);continue}s.set(t.subarray(l,l+c),this.pos),this.pos+=c,this.length+=c,l+=c}return this}digestInto(t){at(this),mn(t,this);const{pos:n,buffer32:s}=this;this.finished=!0,this.buffer.subarray(n).fill(0),this.compress(s,0,!0);const r=ot(t);this.get().forEach((i,o)=>r[o]=i)}digest(){const{buffer:t,outputLen:n}=this;this.digestInto(t);const s=t.slice(0,n);return this.destroy(),s}_cloneInto(t){const{buffer:n,length:s,finished:r,destroyed:i,outputLen:o,pos:a}=this;return t||(t=new this.constructor({dkLen:o})),t.set(...this.get()),t.length=s,t.finished=r,t.destroyed=i,t.outputLen=o,t.buffer.set(n),t.pos=a,t}}const We=BigInt(2**32-1),bt=BigInt(32);function _n(e,t=!1){return t?{h:Number(e&We),l:Number(e>>bt&We)}:{h:Number(e>>bt&We)|0,l:Number(e&We)|0}}function Bs(e,t=!1){let n=new Uint32Array(e.length),s=new Uint32Array(e.length);for(let r=0;r<e.length;r++){const{h:i,l:o}=_n(e[r],t);[n[r],s[r]]=[i,o]}return[n,s]}const As=(e,t)=>BigInt(e>>>0)<<bt|BigInt(t>>>0),Cs=(e,t,n)=>e>>>n,Ss=(e,t,n)=>e<<32-n|t>>>n,Hs=(e,t,n)=>e>>>n|t<<32-n,Os=(e,t,n)=>e<<32-n|t>>>n,Ps=(e,t,n)=>e<<64-n|t>>>n-32,Ls=(e,t,n)=>e>>>n-32|t<<64-n,Us=(e,t)=>t,Rs=(e,t)=>e,Ms=(e,t,n)=>e<<n|t>>>32-n,Ns=(e,t,n)=>t<<n|e>>>32-n,zs=(e,t,n)=>t<<n-32|e>>>64-n,Ds=(e,t,n)=>e<<n-32|t>>>64-n;function Vs(e,t,n,s){const r=(t>>>0)+(s>>>0);return{h:e+n+(r/2**32|0)|0,l:r|0}}const $s=(e,t,n)=>(e>>>0)+(t>>>0)+(n>>>0),js=(e,t,n,s)=>t+n+s+(e/2**32|0)|0,Fs=(e,t,n,s)=>(e>>>0)+(t>>>0)+(n>>>0)+(s>>>0),Gs=(e,t,n,s,r)=>t+n+s+r+(e/2**32|0)|0,Qs=(e,t,n,s,r)=>(e>>>0)+(t>>>0)+(n>>>0)+(s>>>0)+(r>>>0),Ks=(e,t,n,s,r,i)=>t+n+s+r+i+(e/2**32|0)|0,Xs={fromBig:_n,split:Bs,toBig:As,shrSH:Cs,shrSL:Ss,rotrSH:Hs,rotrSL:Os,rotrBH:Ps,rotrBL:Ls,rotr32H:Us,rotr32L:Rs,rotlSH:Ms,rotlSL:Ns,rotlBH:zs,rotlBL:Ds,add:Vs,add3L:$s,add3H:js,add4L:Fs,add4H:Gs,add5H:Ks,add5L:Qs},j=Xs,C=new Uint32Array([4089235720,1779033703,2227873595,3144134277,4271175723,1013904242,1595750129,2773480762,2917565137,1359893119,725511199,2600822924,4215389547,528734635,327033209,1541459225]),d=new Uint32Array(32);function me(e,t,n,s,r,i){const o=r[i],a=r[i+1];let l=d[2*e],c=d[2*e+1],f=d[2*t],u=d[2*t+1],g=d[2*n],p=d[2*n+1],b=d[2*s],_=d[2*s+1],T=j.add3L(l,f,o);c=j.add3H(T,c,u,a),l=T|0,{Dh:_,Dl:b}={Dh:_^c,Dl:b^l},{Dh:_,Dl:b}={Dh:j.rotr32H(_,b),Dl:j.rotr32L(_,b)},{h:p,l:g}=j.add(p,g,_,b),{Bh:u,Bl:f}={Bh:u^p,Bl:f^g},{Bh:u,Bl:f}={Bh:j.rotrSH(u,f,24),Bl:j.rotrSL(u,f,24)},d[2*e]=l,d[2*e+1]=c,d[2*t]=f,d[2*t+1]=u,d[2*n]=g,d[2*n+1]=p,d[2*s]=b,d[2*s+1]=_}function _e(e,t,n,s,r,i){const o=r[i],a=r[i+1];let l=d[2*e],c=d[2*e+1],f=d[2*t],u=d[2*t+1],g=d[2*n],p=d[2*n+1],b=d[2*s],_=d[2*s+1],T=j.add3L(l,f,o);c=j.add3H(T,c,u,a),l=T|0,{Dh:_,Dl:b}={Dh:_^c,Dl:b^l},{Dh:_,Dl:b}={Dh:j.rotrSH(_,b,16),Dl:j.rotrSL(_,b,16)},{h:p,l:g}=j.add(p,g,_,b),{Bh:u,Bl:f}={Bh:u^p,Bl:f^g},{Bh:u,Bl:f}={Bh:j.rotrBH(u,f,63),Bl:j.rotrBL(u,f,63)},d[2*e]=l,d[2*e+1]=c,d[2*t]=f,d[2*t+1]=u,d[2*n]=g,d[2*n+1]=p,d[2*s]=b,d[2*s+1]=_}class qs extends ks{constructor(t={}){super(128,t.dkLen===void 0?64:t.dkLen,t,64,16,16),this.v0l=C[0]|0,this.v0h=C[1]|0,this.v1l=C[2]|0,this.v1h=C[3]|0,this.v2l=C[4]|0,this.v2h=C[5]|0,this.v3l=C[6]|0,this.v3h=C[7]|0,this.v4l=C[8]|0,this.v4h=C[9]|0,this.v5l=C[10]|0,this.v5h=C[11]|0,this.v6l=C[12]|0,this.v6h=C[13]|0,this.v7l=C[14]|0,this.v7h=C[15]|0;const n=t.key?t.key.length:0;if(this.v0l^=this.outputLen|n<<8|65536|1<<24,t.salt){const s=ot(ke(t.salt));this.v4l^=s[0],this.v4h^=s[1],this.v5l^=s[2],this.v5h^=s[3]}if(t.personalization){const s=ot(ke(t.personalization));this.v6l^=s[0],this.v6h^=s[1],this.v7l^=s[2],this.v7h^=s[3]}if(t.key){const s=new Uint8Array(this.blockLen);s.set(ke(t.key)),this.update(s)}}get(){let{v0l:t,v0h:n,v1l:s,v1h:r,v2l:i,v2h:o,v3l:a,v3h:l,v4l:c,v4h:f,v5l:u,v5h:g,v6l:p,v6h:b,v7l:_,v7h:T}=this;return[t,n,s,r,i,o,a,l,c,f,u,g,p,b,_,T]}set(t,n,s,r,i,o,a,l,c,f,u,g,p,b,_,T){this.v0l=t|0,this.v0h=n|0,this.v1l=s|0,this.v1h=r|0,this.v2l=i|0,this.v2h=o|0,this.v3l=a|0,this.v3h=l|0,this.v4l=c|0,this.v4h=f|0,this.v5l=u|0,this.v5h=g|0,this.v6l=p|0,this.v6h=b|0,this.v7l=_|0,this.v7h=T|0}compress(t,n,s){this.get().forEach((l,c)=>d[c]=l),d.set(C,16);let{h:r,l:i}=j.fromBig(BigInt(this.length));d[24]=C[8]^i,d[25]=C[9]^r,s&&(d[28]=~d[28],d[29]=~d[29]);let o=0;const a=Is;for(let l=0;l<12;l++)me(0,4,8,12,t,n+2*a[o++]),_e(0,4,8,12,t,n+2*a[o++]),me(1,5,9,13,t,n+2*a[o++]),_e(1,5,9,13,t,n+2*a[o++]),me(2,6,10,14,t,n+2*a[o++]),_e(2,6,10,14,t,n+2*a[o++]),me(3,7,11,15,t,n+2*a[o++]),_e(3,7,11,15,t,n+2*a[o++]),me(0,5,10,15,t,n+2*a[o++]),_e(0,5,10,15,t,n+2*a[o++]),me(1,6,11,12,t,n+2*a[o++]),_e(1,6,11,12,t,n+2*a[o++]),me(2,7,8,13,t,n+2*a[o++]),_e(2,7,8,13,t,n+2*a[o++]),me(3,4,9,14,t,n+2*a[o++]),_e(3,4,9,14,t,n+2*a[o++]);this.v0l^=d[0]^d[16],this.v0h^=d[1]^d[17],this.v1l^=d[2]^d[18],this.v1h^=d[3]^d[19],this.v2l^=d[4]^d[20],this.v2h^=d[5]^d[21],this.v3l^=d[6]^d[22],this.v3h^=d[7]^d[23],this.v4l^=d[8]^d[24],this.v4h^=d[9]^d[25],this.v5l^=d[10]^d[26],this.v5h^=d[11]^d[27],this.v6l^=d[12]^d[28],this.v6h^=d[13]^d[29],this.v7l^=d[14]^d[30],this.v7h^=d[15]^d[31],d.fill(0)}destroy(){this.destroyed=!0,this.buffer32.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}const Ws=xs(e=>new qs(e));function Ys(e,t,n,s){if(typeof e.setBigUint64=="function")return e.setBigUint64(t,n,s);const r=BigInt(32),i=BigInt(4294967295),o=Number(n>>r&i),a=Number(n&i),l=s?4:0,c=s?0:4;e.setUint32(t+l,o,s),e.setUint32(t+c,a,s)}class Zs extends pn{constructor(t,n,s,r){super(),this.blockLen=t,this.outputLen=n,this.padOffset=s,this.isLE=r,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(t),this.view=ut(this.buffer)}update(t){at(this);const{view:n,buffer:s,blockLen:r}=this;t=ke(t);const i=t.length;for(let o=0;o<i;){const a=Math.min(r-this.pos,i-o);if(a===r){const l=ut(t);for(;r<=i-o;o+=r)this.process(l,o);continue}s.set(t.subarray(o,o+a),this.pos),this.pos+=a,o+=a,this.pos===r&&(this.process(n,0),this.pos=0)}return this.length+=t.length,this.roundClean(),this}digestInto(t){at(this),mn(t,this),this.finished=!0;const{buffer:n,view:s,blockLen:r,isLE:i}=this;let{pos:o}=this;n[o++]=128,this.buffer.subarray(o).fill(0),this.padOffset>r-o&&(this.process(s,0),o=0);for(let u=o;u<r;u++)n[u]=0;Ys(s,r-8,BigInt(this.length*8),i),this.process(s,0);const a=ut(t),l=this.outputLen;if(l%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const c=l/4,f=this.get();if(c>f.length)throw new Error("_sha2: outputLen bigger than state");for(let u=0;u<c;u++)a.setUint32(4*u,f[u],i)}digest(){const{buffer:t,outputLen:n}=this;this.digestInto(t);const s=t.slice(0,n);return this.destroy(),s}_cloneInto(t){t||(t=new this.constructor),t.set(...this.get());const{blockLen:n,buffer:s,length:r,finished:i,destroyed:o,pos:a}=this;return t.length=r,t.pos=a,t.finished=i,t.destroyed=o,r%n&&t.buffer.set(s),t}}const Js=(e,t,n)=>e&t^~e&n,er=(e,t,n)=>e&t^e&n^t&n,tr=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),be=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),ye=new Uint32Array(64);class nr extends Zs{constructor(){super(64,32,8,!1),this.A=be[0]|0,this.B=be[1]|0,this.C=be[2]|0,this.D=be[3]|0,this.E=be[4]|0,this.F=be[5]|0,this.G=be[6]|0,this.H=be[7]|0}get(){const{A:t,B:n,C:s,D:r,E:i,F:o,G:a,H:l}=this;return[t,n,s,r,i,o,a,l]}set(t,n,s,r,i,o,a,l){this.A=t|0,this.B=n|0,this.C=s|0,this.D=r|0,this.E=i|0,this.F=o|0,this.G=a|0,this.H=l|0}process(t,n){for(let u=0;u<16;u++,n+=4)ye[u]=t.getUint32(n,!1);for(let u=16;u<64;u++){const g=ye[u-15],p=ye[u-2],b=ne(g,7)^ne(g,18)^g>>>3,_=ne(p,17)^ne(p,19)^p>>>10;ye[u]=_+ye[u-7]+b+ye[u-16]|0}let{A:s,B:r,C:i,D:o,E:a,F:l,G:c,H:f}=this;for(let u=0;u<64;u++){const g=ne(a,6)^ne(a,11)^ne(a,25),p=f+g+Js(a,l,c)+tr[u]+ye[u]|0,_=(ne(s,2)^ne(s,13)^ne(s,22))+er(s,r,i)|0;f=c,c=l,l=a,a=o+p|0,o=i,i=r,r=s,s=p+_|0}s=s+this.A|0,r=r+this.B|0,i=i+this.C|0,o=o+this.D|0,a=a+this.E|0,l=l+this.F|0,c=c+this.G|0,f=f+this.H|0,this.set(s,r,i,o,a,l,c,f)}roundClean(){ye.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}}const sr=Es(()=>new nr);/*! scure-base - MIT License (c) 2022 Paul Miller (paulmillr.com) */function bn(...e){const t=(r,i)=>o=>r(i(o)),n=Array.from(e).reverse().reduce((r,i)=>r?t(r,i.encode):i.encode,void 0),s=e.reduce((r,i)=>r?t(r,i.decode):i.decode,void 0);return{encode:n,decode:s}}function rr(e){return{encode:t=>{if(!Array.isArray(t)||t.length&&typeof t[0]!="number")throw new Error("alphabet.encode input should be an array of numbers");return t.map(n=>{if(n<0||n>=e.length)throw new Error(`Digit index outside alphabet: ${n} (alphabet: ${e.length})`);return e[n]})},decode:t=>{if(!Array.isArray(t)||t.length&&typeof t[0]!="string")throw new Error("alphabet.decode input should be array of strings");return t.map(n=>{if(typeof n!="string")throw new Error(`alphabet.decode: not string element=${n}`);const s=e.indexOf(n);if(s===-1)throw new Error(`Unknown letter: "${n}". Allowed: ${e}`);return s})}}}function ir(e=""){if(typeof e!="string")throw new Error("join separator should be string");return{encode:t=>{if(!Array.isArray(t)||t.length&&typeof t[0]!="string")throw new Error("join.encode input should be array of strings");for(let n of t)if(typeof n!="string")throw new Error(`join.encode: non-string input=${n}`);return t.join(e)},decode:t=>{if(typeof t!="string")throw new Error("join.decode input should be string");return t.split(e)}}}function Mt(e,t,n){if(t<2)throw new Error(`convertRadix: wrong from=${t}, base cannot be less than 2`);if(n<2)throw new Error(`convertRadix: wrong to=${n}, base cannot be less than 2`);if(!Array.isArray(e))throw new Error("convertRadix: data should be array");if(!e.length)return[];let s=0;const r=[],i=Array.from(e);for(i.forEach(o=>{if(o<0||o>=t)throw new Error(`Wrong integer: ${o}`)});;){let o=0,a=!0;for(let l=s;l<i.length;l++){const c=i[l],f=t*o+c;if(!Number.isSafeInteger(f)||t*o/t!==o||f-c!==t*o)throw new Error("convertRadix: carry overflow");o=f%n;const u=Math.floor(f/n);if(i[l]=u,!Number.isSafeInteger(u)||u*n+o!==f)throw new Error("convertRadix: carry overflow");if(a)u?a=!1:s=l;else continue}if(r.push(o),a)break}for(let o=0;o<e.length-1&&e[o]===0;o++)r.push(0);return r.reverse()}function or(e){return{encode:t=>{if(!(t instanceof Uint8Array))throw new Error("radix.encode input should be Uint8Array");return Mt(Array.from(t),2**8,e)},decode:t=>{if(!Array.isArray(t)||t.length&&typeof t[0]!="number")throw new Error("radix.decode input should be array of strings");return Uint8Array.from(Mt(t,e,2**8))}}}function ar(e,t){if(typeof t!="function")throw new Error("checksum fn should be function");return{encode(n){if(!(n instanceof Uint8Array))throw new Error("checksum.encode: input should be Uint8Array");const s=t(n).slice(0,e),r=new Uint8Array(n.length+e);return r.set(n),r.set(s,n.length),r},decode(n){if(!(n instanceof Uint8Array))throw new Error("checksum.decode: input should be Uint8Array");const s=n.slice(0,-e),r=t(s).slice(0,e),i=n.slice(-e);for(let o=0;o<e;o++)if(r[o]!==i[o])throw new Error("Invalid checksum");return s}}}const lr=e=>bn(or(58),rr(e),ir("")),yn=lr("123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"),ur=e=>bn(ar(4,t=>e(e(t))),yn);var cr=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function hr(e){xt(e,Uint8Array);let t="";for(let n=0,s=e.length;n<s;n++)t+=cr[e[n]];return t}function dr(e){cn(e,"string"),oe(e.length%2===0,"Invalid hex padding.");const t=new Uint8Array(e.length/2);for(let n=0,s=0,r=t.length;n<r;n++){const i=Nt(e.charCodeAt(s++)),o=Nt(e.charCodeAt(s++));t[n]=i*16+o}return t}function Nt(e){if(e>=48&&e<=57)return e-48;if(e>=65&&e<=70)return e-(65-10);if(e>=97&&e<=102)return e-(97-10);throw new Error("Invalid byte sequence.")}var S={encode:hr,decode:dr};function fr(e){return xt(e,Uint8Array),new TextDecoder().decode(e)}function gr(e){return cn(e,"string"),new Uint8Array(new TextEncoder().encode(e))}var ht={encode:fr,decode:gr};ur(pr);var Le=yn;function wn(e){return e instanceof Uint8Array?e:S.decode(e)}function Ne(e){return Ws(wn(e),{dkLen:32})}function pr(e){return sr(wn(e))}function mr(e){e.length%2&&(e="0"+e);const t=BigInt("0x"+e);return 128&parseInt(e.slice(0,2),16)?-vn(t):t}function _r(e){const t=e>=E;t||(e=vn(e));let n=e.toString(16);return n.length%2&&(n="0"+n),t&&128&parseInt(n.slice(0,2),16)&&(n="00"+n),n}function vn(e){const t=e<E;t&&(e=-e);const n=e.toString(2);let s=n.length;const r=s%8;r>0?s+=8-r:t&&we(n)==="1"&&n.indexOf("1",1)!==-1&&(s+=8);const i=(1n<<BigInt(s))-1n;return(~e&i)+1n}function br(e,t){if(t===0)return e.write(0);if(t<0)throw new RangeError("Variable Length Quantity not supported for negative numbers.");do{let n=t&127;t>>=7,t>0&&(n|=128),e.write(n)}while(t>0);return e}function dt(e){if(e.isEmpty)return 0;let t=0,n=0,s=0;do s=e.readByte(),t|=(s&127)<<n,n+=7;while(s&128);return t}function yr(e,t){if(t===E)return e.write(0);if(t<E)throw new RangeError("Variable Length Quantity not supported for negative numbers");do{let n=Number(t&dn);t>>=hn,t>0&&(n|=128),e.write(n)}while(t>0);return e}function wr(e){if(e.isEmpty)return E;let t=E,n=E,s=E;do s=BigInt(e.readByte()),t|=(s&dn)<<n,n+=hn;while((s&fn)!=E);return t}function $(e){let t=0;if(typeof e=="number"){do t++,e=Math.floor(e/128);while(e>0);return t}e=O(e);do t++,e/=fn;while(e>E);return t}function vr(e){return e<<1^e>>63}function Er(e){return e>>1^-(e&1)}function xr(e){return e<<it^e>>ps}function Tr(e){return e>>it^-(e&it)}var ue,re,en,Ir=(en=class{constructor(e){pe(this,ue,void 0);pe(this,re,void 0);typeof e=="string"?q(this,ue,S.decode(e)):q(this,ue,e),q(this,re,0)}get isEmpty(){return J(A(this,ue))}readBoolean(){return this.readByte()===1}readBits(e){const t=new Array(e);let n=0;for(let s=0;s<e;s++){const r=A(this,ue)[A(this,re)]>>n++&1;t[s]=r===1,n==8&&(n=0,xe(this,re)._++)}return n>0&&xe(this,re)._++,t}readByte(){return A(this,ue)[xe(this,re)._++]}readBytes(e){return A(this,ue).subarray(A(this,re),q(this,re,A(this,re)+e))}readVlq(){return dt(this)}readShort(){return Number(Er(dt(this)))}readInt(){const e=this.readLong();return Number(e)}readLong(){return Tr(wr(this))}readBigInt(){const e=dt(this);return mr(S.encode(this.readBytes(e)))}},ue=new WeakMap,re=new WeakMap,en),ce,Q,tn,It=(tn=class{constructor(e){pe(this,ce,void 0);pe(this,Q,void 0);q(this,ce,new Uint8Array(e)),q(this,Q,0)}get length(){return A(this,Q)}writeBoolean(e){return this.write(e===!0?1:0),this}writeVLQ(e){return br(this,e)}writeBigVLQ(e){return yr(this,e)}writeShort(e){return this.writeVLQ(vr(e)),this}writeInt(e){return this.writeLong(BigInt(e)),this}writeLong(e){return this.writeBigVLQ(xr(e)),this}write(e){return A(this,ce)[xe(this,Q)._++]=e,this}writeBytes(e){return A(this,ce).set(e,A(this,Q)),q(this,Q,A(this,Q)+e.length),this}writeHex(e){return this.writeBytes(S.decode(e))}writeBits(e){let t=0;for(let n=0;n<e.length;n++)e[n]?A(this,ce)[A(this,Q)]|=1<<t++:A(this,ce)[A(this,Q)]&=~(1<<t++),t==8&&(t=0,xe(this,Q)._++);return t>0&&xe(this,Q)._++,this}writeBigInt(e){const t=_r(e);return this.writeVLQ(t.length/2),this.writeHex(t),this}toHex(){return S.encode(this.toBytes())}toBytes(){return A(this,ce).subarray(0,A(this,Q))}},ce=new WeakMap,Q=new WeakMap,tn),En=class{coerce(e){return e}},xn=class extends En{get embeddable(){return!1}},ve=class extends xn{get embeddable(){return!0}},Ve,nn,Tn=(nn=class extends En{constructor(t){super();pe(this,Ve,void 0);q(this,Ve,t)}get elementsType(){return A(this,Ve)}get embeddable(){return!1}},Ve=new WeakMap,nn),In=class extends ve{get code(){return 1}toString(){return"SBool"}},kn=class extends ve{get code(){return 2}toString(){return"SByte"}},Bn=class extends ve{get code(){return 3}toString(){return"SShort"}},An=class extends ve{get code(){return 4}toString(){return"SInt"}},Cn=class extends ve{get code(){return 5}coerce(e){return O(e)}toString(){return"SLong"}},Sn=class extends ve{get code(){return 6}coerce(e){return O(e)}toString(){return"SBigInt"}},Hn=class extends ve{get code(){return 7}coerce(e){return typeof e=="string"?S.decode(e):e}toString(){return"SGroupElement"}},On=class extends ve{get code(){return 8}toString(){return"SSigmaProp"}},Pn=class extends xn{get code(){return 98}toString(){return"SUnit"}},D=Object.freeze({embeddable:0,simpleColl:1,nestedColl:2,option:3,optionCollection:4,pairOne:5,pairTwo:6,symmetricPair:7,genericTuple:8}),Ln=11,yt=Ln+1,se=e=>yt*e,kr=Object.freeze({code:se(D.simpleColl),embeddable:!1,simpleCollTypeCode:se(D.simpleColl),nestedCollTypeCode:se(D.nestedColl)}),Br=Object.freeze({code:se(D.pairOne),embeddable:!1,pairOneTypeCode:se(D.pairOne),pairTwoTypeCode:se(D.pairTwo),tripleTypeCode:se(D.pairTwo),symmetricPairTypeCode:se(D.symmetricPair),quadrupleTypeCode:se(D.symmetricPair),genericTupleTypeCode:se(D.genericTuple)}),h={bool:new In,byte:new kn,short:new Bn,int:new An,long:new Cn,bigInt:new Sn,groupElement:new Hn,sigmaProp:new On,unit:new Pn,coll:kr,tuple:Br};function wt(e){return e.code>=h.coll.simpleCollTypeCode&&e.code<=h.coll.nestedCollTypeCode+Ln}function Un(e){return e.code>=h.tuple.pairOneTypeCode&&e.code<=h.tuple.genericTupleTypeCode}function Te(e){switch(e){case h.bool.code:return h.bool;case h.byte.code:return h.byte;case h.short.code:return h.short;case h.int.code:return h.int;case h.long.code:return h.long;case h.bigInt.code:return h.bigInt;case h.groupElement.code:return h.groupElement;case h.sigmaProp.code:return h.sigmaProp;default:throw new Error(`The type code '0x${e.toString(16)}' is not a valid primitive type code.`)}}var et=class extends Tn{get code(){return h.coll.code}coerce(e){return this.elementsType.code===h.byte.code&&!(e instanceof Uint8Array)?typeof e=="string"?S.decode(e):Uint8Array.from(e):e.map(t=>this.elementsType.coerce(t))}toString(){return`SColl[${this.elementsType.toString()}]`}},Ue=class extends Tn{get code(){return h.tuple.code}coerce(e){const t=new Array(e.length);for(let n=0;n<e.length;n++)t[n]=this.elementsType[n].coerce(e[n]);return t}toString(){return`(${this.elementsType.map(e=>e.toString()).join(", ")})`}};function de(e,t,n){return new Proxy(e,{apply:(s,r,i)=>{const o=t??new s;return!n&&J(i)?o:new ze(o,...i)}})}function Rn(e,t){return new Proxy(e,{apply:t})}var ft=de(kn,h.byte);de(In,h.bool);de(Bn,h.short);de(An,h.int);de(Cn,h.long);de(Sn,h.bigInt);de(Hn,h.groupElement);de(On,h.sigmaProp);de(Pn,void 0,!0);var gt=Rn(et,(e,t,n)=>{const[s,r]=n,i=s();return r?new ze(new e(i),r):()=>new e(i)});Rn(Ue,(e,t,n)=>{const[s,r]=n;if(typeof s=="function"&&typeof r=="function")return()=>new e([s(),r()]);if(s instanceof ze&&r instanceof ze)return new ze(new e([s.type,r.type]),[s.data,r.data]);throw new Error("Invalid tuple declaration.")});var Ar=33,zt=205,Dt=class tt{static serialize(t,n,s){if(n.embeddable)switch(n.code){case h.bool.code:return s.writeBoolean(t);case h.byte.code:return s.write(t);case h.short.code:return s.writeShort(t);case h.int.code:return s.writeInt(t);case h.long.code:return s.writeLong(t);case h.bigInt.code:return s.writeBigInt(t);case h.groupElement.code:return s.writeBytes(t);case h.sigmaProp.code:{const r=t;if(r.type===h.groupElement)return s.write(zt),tt.serialize(r.data,r.type,s);throw Error("Serialization error: SigmaProp operation not implemented.")}}else if(wt(n)){if(n.elementsType.code===h.byte.code){const r=t instanceof Uint8Array;oe(r,`SColl[Byte] expected an UInt8Array, got ${typeof t}.`)}else oe(Array.isArray(t),`SColl expected an array, got ${typeof t}.`);switch(s.writeVLQ(t.length),n.elementsType.code){case h.bool.code:return s.writeBits(t);case h.byte.code:return s.writeBytes(t);default:{for(let r=0;r<t.length;r++)tt.serialize(t[r],n.elementsType,s);return s}}}else if(Un(n)){oe(Array.isArray(t),`STupleType serialization expected an array, got ${typeof t}.`);const r=n.elementsType.length;for(let i=0;i<r;i++)tt.serialize(t[i],n.elementsType[i],s);return s}else if(n.code===h.unit.code)return s;throw Error(`Serialization error: '0x${n.code.toString(16)}' type not implemented.`)}static deserialize(t,n){if(t.embeddable)switch(t.code){case h.bool.code:return n.readBoolean();case h.byte.code:return n.readByte();case h.short.code:return n.readShort();case h.int.code:return n.readInt();case h.long.code:return n.readLong();case h.bigInt.code:return n.readBigInt();case h.groupElement.code:return n.readBytes(Ar);case h.sigmaProp.code:{if(n.readByte()===zt)return this.deserialize(h.groupElement,n);break}}else switch(t.code){case h.coll.code:{const s=n.readVlq(),r=t.elementsType;switch(r.code){case h.bool.code:return n.readBits(s);case h.byte.code:return n.readBytes(s);default:{const i=new Array(s);for(let o=0;o<s;o++)i[o]=this.deserialize(r,n);return i}}}case h.tuple.code:return t.elementsType.map(s=>this.deserialize(s,n));case h.unit.code:return}throw new Error(`Parsing error: '0x${t.code.toString(16)}' type not implemented.`)}},Vt=class{static serialize(e,t){if(e.embeddable)t.write(e.code);else if(e.code===h.unit.code)t.write(e.code);else if(wt(e))if(e.elementsType.embeddable)t.write(h.coll.simpleCollTypeCode+e.elementsType.code);else if(wt(e.elementsType)){const n=e.elementsType;n.elementsType.embeddable?t.write(h.coll.nestedCollTypeCode+n.elementsType.code):(t.write(h.coll.simpleCollTypeCode),this.serialize(n,t))}else t.write(h.coll.simpleCollTypeCode),this.serialize(e.elementsType,t);else if(Un(e)){switch(e.elementsType.length){case 2:{const n=we(e.elementsType),s=ls(e.elementsType);n.embeddable?n.code===s.code?t.write(h.tuple.symmetricPairTypeCode+n.code):(t.write(h.tuple.pairOneTypeCode+n.code),this.serialize(s,t)):s.embeddable?(t.write(h.tuple.pairTwoTypeCode+s.code),this.serialize(n,t)):(t.write(h.tuple.pairOneTypeCode),this.serialize(n,t),this.serialize(s,t));return}case 3:t.write(h.tuple.tripleTypeCode);break;case 4:t.write(h.tuple.quadrupleTypeCode);break;default:{const n=e.elementsType.length;oe(n>=2&&n<=255,"Invalid type: tuples must have between 2 and 255 items."),t.write(h.tuple.genericTupleTypeCode),t.writeVLQ(n)}}for(let n=0;n<e.elementsType.length;n++)this.serialize(e.elementsType[n],t)}else throw new Error("Serialization error: type not implemented.")}static deserialize(e){const t=e.readByte();if(oe(t>0,`Parsing Error: Unexpected type code '0x${t.toString(16)}'`),t<h.tuple.genericTupleTypeCode){const n=Math.floor(t/yt),s=Math.floor(t%yt);switch(n){case D.embeddable:return Te(s);case D.simpleColl:{const r=s===0?this.deserialize(e):Te(s);return new et(r)}case D.nestedColl:return new et(new et(Te(s)));case D.pairOne:{const r=s===0?[this.deserialize(e),this.deserialize(e)]:[Te(s),this.deserialize(e)];return new Ue(r)}case D.pairTwo:{const r=s===0?[this.deserialize(e),this.deserialize(e),this.deserialize(e)]:[this.deserialize(e),Te(s)];return new Ue(r)}case D.symmetricPair:{const r=s===0?[this.deserialize(e),this.deserialize(e),this.deserialize(e),this.deserialize(e)]:[Te(s),Te(s)];return new Ue(r)}}}else switch(t){case h.tuple.genericTupleTypeCode:{const n=e.readVlq(),s=new Array(n);for(let r=0;r<n;r++)s[r]=this.deserialize(e);return new Ue(s)}case h.unit.code:return h.unit}throw new Error("Not implemented.")}},Cr=4096,$e,je,Fe,ze=(Fe=class{constructor(t,n){pe(this,$e,void 0);pe(this,je,void 0);q(this,$e,t),q(this,je,t.coerce(n))}static from(t){oe(t.length>0,"Empty constant bytes.");const n=new Ir(t),s=Vt.deserialize(n),r=Dt.deserialize(s,n);return new Fe(s,r)}get type(){return A(this,$e)}get data(){return A(this,je)}toBytes(){const t=new It(Cr);return Vt.serialize(this.type,t),Dt.serialize(this.data,this.type,t),t.toBytes()}toHex(){return S.encode(this.toBytes())}},$e=new WeakMap,je=new WeakMap,Fe),Sr=65535;function Mn(e,t,n){if(t||(t=new It(5e4)),t.writeBigVLQ(O(e.value)),t.writeHex(e.ergoTree),t.writeVLQ(e.creationHeight),Hr(t,e.assets,n),Or(t,e.additionalRegisters),k(n))return t;if(!Nn(e))throw new Error("Invalid box type.");return t.writeHex(e.transactionId).writeVLQ(e.index)}function Nn(e){const t=e;return k(t.transactionId)&&k(t.index)}function Hr(e,t,n){if(J(t)){e.write(0);return}e.writeVLQ(t.length),z(n)?t.map(s=>e.writeVLQ(n.indexOf(s.tokenId)).writeBigVLQ(O(s.amount))):t.map(s=>e.writeHex(s.tokenId).writeBigVLQ(O(s.amount)))}function Or(e,t){const n=Object.keys(t).sort();let s=0;for(const r of n)t[r]&&s++;if(e.writeVLQ(s),s!=0)for(const r of n){const i=t[r];k(i)&&e.writeHex(i)}}function Pr(e,t){if(V(e.creationHeight))throw new Error("Box size estimation error: creation height is undefined.");let n=0;n+=$(k(t)?t:e.value),n+=Me(e.ergoTree),n+=$(e.creationHeight),n+=$(e.assets.length),n+=e.assets.reduce((r,i)=>r+=Me(i.tokenId)+$(i.amount),0);let s=0;for(const r in e.additionalRegisters){const i=e.additionalRegisters[r];i&&(n+=Me(i),s++)}return n+=$(s),n+=32,n+=$(Nn(e)?e.index:Sr),n}function Lr(e){const t=new It(1e5);t.writeVLQ(e.inputs.length),e.inputs.map(s=>Ur(t,s)),t.writeVLQ(e.dataInputs.length),e.dataInputs.map(s=>t.writeHex(s.boxId));const n=Mr(e.outputs);return t.writeVLQ(n.length),n.map(s=>t.writeHex(s)),t.writeVLQ(e.outputs.length),e.outputs.map(s=>Mn(s,t,n)),t}function Ur(e,t){e.writeHex(t.boxId),e.write(0),Rr(e,t.extension)}function Rr(e,t){const n=Object.keys(t);let s=0;for(const r of n){const i=t[r];k(i)&&s++}if(e.writeVLQ(s),s!=0)for(const r of n){const i=t[r];k(i)&&e.writeVLQ(Number(r)).writeHex(i)}}function Mr(e){const t=new Set;return e.flatMap(n=>n.assets.map(s=>t.add(s.tokenId))),Array.from(t)}var Nr=class extends Error{constructor(){super("One or more inputs was selected more than one time by the current selection strategy.")}},zr=class extends Error{constructor(t){const n=[];if(t.nanoErgs&&n.push($t("nanoErgs",t.nanoErgs)),z(t.tokens))for(const s of t.tokens)n.push($t(s.tokenId,s.amount));super(`Insufficient inputs:${n.join()}`);m(this,"unreached");this.unreached=t}};function $t(e,t){return`
  > ${e}: ${t==null?void 0:t.toString()}`}var Dr=class{constructor(){m(this,"_inputs")}select(e,t){this._inputs=e;let n=[];z(t.tokens)&&(n=this._selectTokens(t.tokens));const s=_t(n,r=>r.value);if(V(t.nanoErgs)&&J(t.tokens)||k(t.nanoErgs)&&s<t.nanoErgs){const r=k(t.nanoErgs)?t.nanoErgs-s:void 0;n=n.concat(this._select(r))}return n}_selectTokens(e){let t=[];for(const n of e){const s=k(n.amount)?n.amount-he(t,n.tokenId):void 0;s&&s<=E||(t=t.concat(this._select(s,n.tokenId)))}return t}_select(e,t){const n=this._inputs;let s=E,r=[];if(V(e))t?r=n.filter(i=>i.assets.some(o=>o.tokenId===t)):r=n;else for(let i=0;i<n.length&&s<e;i++)if(t)for(const o of n[i].assets)o.tokenId===t&&(s+=o.amount,r.push(n[i]));else s+=n[i].value,r.push(n[i]);return z(r)&&(this._inputs=this._inputs.filter(i=>!r.includes(i))),r}},Vr=class{constructor(e){m(this,"_selector");this._selector=e}select(e,t){return this._selector(e,t)}},$r=class{constructor(e){m(this,"_inputs");m(this,"_strategy");m(this,"_ensureFilterPredicate");m(this,"_selector");m(this,"_sortDirection");m(this,"_ensureInclusionBoxIds");this._inputs=e}defineStrategy(e){return this._isISelectionStrategyImplementation(e)?this._strategy=e:this._strategy=new Vr(e),this}select(e){this._strategy||(this._strategy=new Dr);const t=this._deepCloneTarget(e);let n=[...this._inputs],s=[];const r=this._ensureFilterPredicate,i=this._ensureInclusionBoxIds;if(r?i?s=n.filter(a=>r(a)||i.has(a.boxId)):s=n.filter(r):i&&(s=n.filter(a=>i.has(a.boxId))),z(s)&&(n=n.filter(a=>!s.some(l=>l.boxId===a.boxId)),t.nanoErgs&&t.nanoErgs>E&&(t.nanoErgs-=_t(s,a=>a.value)),z(t.tokens)&&s.some(a=>!J(a.assets))))for(const a of t.tokens)a.amount&&a.amount>E&&(a.amount-=he(s,a.tokenId));if(this._selector&&(n=ds(n,this._selector,this._sortDirection||"asc")),s=s.concat(this._strategy.select(n,t)),cs(s,a=>a.boxId))throw new Nr;const o=this._getUnreachedTargets(s,e);if(o.nanoErgs||z(o.tokens))throw new zr(o);return s}_deepCloneTarget(e){return{nanoErgs:e.nanoErgs,tokens:e.tokens?e.tokens.map(t=>({tokenId:t.tokenId,amount:t.amount})):void 0}}_getUnreachedTargets(e,t){const n={nanoErgs:void 0,tokens:void 0},s=_t(e,r=>r.value);if(t.nanoErgs&&t.nanoErgs>s&&(n.nanoErgs=t.nanoErgs-s),J(t.tokens))return n;for(const r of t.tokens){const i=he(e,r.tokenId);if(r.amount&&r.amount>i){if(r.tokenId===we(e).boxId)continue;V(n.tokens)&&(n.tokens=[]),n.tokens.push({tokenId:r.tokenId,amount:r.amount-i})}}return n}ensureInclusion(e){if(typeof e=="function")this._ensureFilterPredicate=e;else if(e==="all")this._ensureFilterPredicate=t=>t.value>0n;else if(V(this._ensureInclusionBoxIds)&&(this._ensureInclusionBoxIds=new Set),Array.isArray(e))for(const t of e)this._ensureInclusionBoxIds.add(t);else this._ensureInclusionBoxIds.add(e);return this}orderBy(e,t){return this._selector=e,this._sortDirection=t,this}_isISelectionStrategyImplementation(e){return!!e.select}static buildTargetFrom(e){const t={};let n=E;for(const s of e){n+=O(s.value);for(const r of s.assets)t[r.tokenId]=(t[r.tokenId]||E)+O(r.amount)}return{nanoErgs:n,tokens:Object.keys(t).map(s=>({tokenId:s,amount:t[s]}))}}},jr=class extends Error{constructor(){super("Registers should be densely packed. This means that it's not possible to use a register like 'R7' without filling 'R6', 'R5' and 'R4', for example.")}},Fr=class extends Error{constructor(){super("Minting context is undefined. Transaction's inputs must be included in order to determine minting token id.")}},Gr=class extends Error{constructor(){super("Creation Height is undefined.")}},Qr=class extends Error{constructor(e){super(`Invalid Ergo address: ${e}`)}},Ie=4,Kr=32,vt=S.decode("0008cd"),Xr=36,zn=S.decode("d40801"),nt=S.decode("00ea02d193b4cbe4e3010e040004300e18"),qr=44,Ye=24;function jt(e){return we(e)&240}function pt(e){return we(e)&15}function Ft(e){return typeof e=="string"?S.decode(e):e}function Wr(e){return e.length===Xr&&Lt(e,vt)?W.P2PK:e.length===qr&&Lt(e,nt)&&gs(e,zn)?W.P2SH:W.P2S}function Gt(e){return J(e)||e.length!==33?!1:e[0]===2||e[0]===3}var De=class He{constructor(t,n){m(this,"_ergoTree");m(this,"_network");m(this,"_type");this._ergoTree=t,this._network=n,this._type=Wr(t)}get network(){return this._network}get ergoTree(){return S.encode(this._ergoTree)}get type(){return this._type}static fromErgoTree(t,n){return new He(S.decode(t),n)}static fromPublicKey(t,n){const s=Ft(t);if(!Gt(s))throw new Error("The Public Key is invalid.");const r=qe(vt,s);return new He(r,n)}static fromHash(t,n){if(t=Ft(t),t.length===Kr)t=t.subarray(0,Ye);else if(t.length!=Ye)throw Error(`Invalid hash length: ${t.length}`);const s=qe(nt,t,zn);return new He(s,n)}static fromBase58(t,n=!1){const s=Le.decode(t);if(!n&&!He.validate(s))throw new Qr(t);const r=jt(s),i=pt(s),o=s.subarray(1,s.length-Ie);return i===W.P2PK?this.fromPublicKey(o,r):i===W.P2SH?this.fromHash(o,r):new He(o,r)}static validate(t){const n=typeof t=="string"?Le.decode(t):t;if(n.length<Ie)return!1;if(pt(n)===W.P2PK){const a=n.subarray(1,n.length-Ie);if(!Gt(a))return!1}const s=n.subarray(0,n.length-Ie),r=n.subarray(n.length-Ie,n.length),o=Ne(s).subarray(0,Ie);return fs(o,r)}static getNetworkType(t){return jt(Le.decode(t))}static getAddressType(t){return pt(Le.decode(t))}getPublicKeys(){return this.type===W.P2PK?[this._ergoTree.subarray(vt.length)]:[]}toP2SH(t){if(this.type===W.P2SH)return this.encode();const n=Ne(this._ergoTree).subarray(0,Ye);return this._encode(n,W.P2SH,t)}encode(t){let n;return this.type===W.P2PK?n=we(this.getPublicKeys()):this.type===W.P2SH?n=this._ergoTree.subarray(nt.length,nt.length+Ye):n=this._ergoTree,this._encode(n,this.type,t)}_encode(t,n,s){k(s)||(k(this.network)?s=this.network:s=lt.Mainnet);const r=Uint8Array.from([s+n]);t=qe(r,t);const i=Ne(t).subarray(0,Ie);return Le.encode(qe(t,i))}toString(t){return this.encode(t)}},Yr=class Dn{constructor(t){m(this,"boxId");m(this,"value");m(this,"ergoTree");m(this,"creationHeight");m(this,"assets");m(this,"additionalRegisters");m(this,"transactionId");m(this,"index");this.boxId=t.boxId,this.ergoTree=t.ergoTree,this.creationHeight=t.creationHeight,this.value=O(t.value),this.assets=t.assets.map(n=>({tokenId:n.tokenId,amount:O(n.amount)})),this.additionalRegisters=t.additionalRegisters,this.transactionId=t.transactionId,this.index=t.index}isValid(){return Dn.validate(this)}static validate(t){const n=Mn(t).toBytes(),s=S.encode(Ne(n));return t.boxId===s}},Qt=class extends Yr{constructor(t){super(t);m(this,"_extension");t.extension&&this.setContextVars(t.extension)}get extension(){return this._extension}setContextVars(t){return this._extension=t,this}toUnsignedInputObject(t){return{...this.toPlainObject(t),extension:this._extension||{}}}toPlainObject(t){return t==="EIP-12"?{boxId:this.boxId,value:this.value.toString(),ergoTree:this.ergoTree,creationHeight:this.creationHeight,assets:this.assets.map(n=>({tokenId:n.tokenId,amount:n.amount.toString()})),additionalRegisters:this.additionalRegisters,transactionId:this.transactionId,index:this.index}:{boxId:this.boxId}}},Zr=class{constructor(e,t,n){m(this,"_inputs");m(this,"_dataInputs");m(this,"_outputs");this._inputs=Object.freeze(e),this._dataInputs=Object.freeze(t),this._outputs=Object.freeze(n)}get id(){return S.encode(Ne(this.toBytes()))}get inputs(){return this._inputs}get dataInputs(){return this._dataInputs}get outputs(){return this._outputs}get burning(){return Je(he(this.inputs),he(this.outputs))}toPlainObject(e){return{inputs:this.inputs.map(t=>t.toUnsignedInputObject(e||"default")),dataInputs:this.dataInputs.map(t=>t.toPlainObject(e||"default")),outputs:this.outputs.map(t=>Jr(t))}}toEIP12Object(){return this.toPlainObject("EIP-12")}toBytes(){return Lr({inputs:this.inputs.map(e=>e.toUnsignedInputObject("default")),dataInputs:this.dataInputs.map(e=>e.toPlainObject("default")),outputs:this.outputs}).toBytes()}};function Jr(e){return{...e,value:e.value.toString(),assets:e.assets.map(t=>({tokenId:t.tokenId,amount:t.amount.toString()}))}}var ei=class extends Error{constructor(e){super(`Box '${e}' is already included.`)}},ti=class extends Error{constructor(e){super(e)}},ni=class extends Error{constructor(e){super(`Invalid input: ${e}`)}},Kt=class extends Error{constructor(e){super(`Malformed transaction: ${e}`)}},si=class extends Error{constructor(){super(`A box must contain no more than ${Bt} distinct tokens.`)}},Vn=class extends Error{constructor(){super("This transaction is trying to burn tokens. If that's your intention you must explicitly allow token burning on TransactionBuilder.configure() method. If no, a change address should be provided.")}},kt=class extends Error{constructor(e){super(e)}},Bt=120,Et=class extends Tt{constructor(e,t){super(),k(e)&&this.add(e,t)}_map(e){return{tokenId:e.tokenId,amount:O(e.amount)}}_addOne(e,t){if((V(t)||t.sum&&!k(t.index))&&this._sum(this._map(e)))return this.length;if(this._items.length>=Bt)throw new si;return super._addOne(e,t),this.length}add(e,t){return super.add(e,t)}_sum(e){for(const t of this._items)if(t.tokenId===e.tokenId)return t.amount+=e.amount,!0;return!1}remove(e,t){let n=-1;if(typeof e=="number"){if(this._isIndexOutOfBounds(e))throw new RangeError(`Index '${e}' is out of range.`);n=e}else if(n=this._items.findIndex(s=>s.tokenId===e),this._isIndexOutOfBounds(n))throw new kt(`TokenId '${e}' not found in assets collection.`);if(t&&n>-1){const s=O(t),r=this._items[n];if(s>r.amount)throw new ti("Insufficient token amount to perform a subtraction operation.");if(s<r.amount)return r.amount-=s,this.length}return this._items.splice(n,1),this.length}contains(e){return this._items.some(t=>t.tokenId===e)}},Xt=class extends Tt{constructor(e){super(),k(e)&&this.add(e)}_map(e){return e instanceof Qt?e:new Qt(e)}_addOne(e){if(this._items.some(t=>t.boxId===e.boxId))throw new ei(e.boxId);return super._addOne(e)}remove(e){let t=-1;if(typeof e=="number"){if(this._isIndexOutOfBounds(e))throw new RangeError(`Index '${e}' is out of range.`);t=e}else if(t=this._items.findIndex(n=>n.boxId===e),this._isIndexOutOfBounds(t))throw new kt("The input you are trying to remove is not present in the inputs collection.");return this._items.splice(t,1),this.length}},ri=class $n extends Tt{constructor(t){super(),k(t)&&this.add(t)}_map(t){return t}remove(t){let n=-1;if(typeof t=="number"){if(this._isIndexOutOfBounds(t))throw new RangeError(`Index '${t}' is out of range.`);n=t}else if(n=this._items.lastIndexOf(t),this._isIndexOutOfBounds(n))throw new kt("The output you are trying to remove is not present in the outputs collection.");return this._items.splice(n,1),this.length}clone(){return new $n(this._items)}sum(t){const n={};let s=E;if(t&&(t.nanoErgs&&(s=t.nanoErgs),z(t.tokens)))for(const r of t.tokens)V(r.amount)||(n[r.tokenId]=(n[r.tokenId]||E)+r.amount);for(const r of this._items){s+=r.value;for(const i of r.assets)n[i.tokenId]=(n[i.tokenId]||E)+i.amount}return{nanoErgs:s,tokens:Object.keys(n).map(r=>({tokenId:r,amount:n[r]}))}}},ii=7,oi=class{constructor(e){m(this,"_bytes");typeof e=="string"?this._bytes=S.decode(e):this._bytes=e}get header(){return this._bytes[0]}get version(){return this.header&ii}get hasSegregatedConstants(){return(this.header&Rt.constantSegregation)!=0}get hasSize(){return(this.header&Rt.sizeInclusion)!=0}toBytes(){return this._bytes}toHex(){return S.encode(this.toBytes())}toAddress(e=lt.Mainnet){return De.fromErgoTree(this.toHex(),e)}},jn=BigInt(360),At=BigInt(1e6);function ai(e=jn){return t=>BigInt(t.estimateSize())*e}var Re=class{constructor(e,t,n){m(this,"_address");m(this,"_tokens");m(this,"_value");m(this,"_valueEstimator");m(this,"_creationHeight");m(this,"_registers");m(this,"_minting");this.setValue(e),this._creationHeight=n,this._tokens=new Et,this._registers={},typeof t=="string"?this._address=gn(t)?De.fromErgoTree(t):De.fromBase58(t):t instanceof oi?this._address=t.toAddress():this._address=t}get value(){return k(this._valueEstimator)?this._valueEstimator(this):this._value}get address(){return this._address}get ergoTree(){return this._address.ergoTree}get creationHeight(){return this._creationHeight}get assets(){return this._tokens}get additionalRegisters(){return this._registers}get minting(){return this._minting}setValue(e){if(typeof e=="function")this._valueEstimator=e;else if(this._value=O(e),this._valueEstimator=void 0,this._value<=E)throw new Error("An UTxO cannot be created without a minimum required amount.");return this}addTokens(e,t){return e instanceof Et?this._tokens.add(e.toArray(),t):this._tokens.add(e,t),this}addNfts(...e){const t=e.map(n=>({tokenId:n,amount:it}));return this.addTokens(t)}mintToken(e){return this._minting={...e,amount:O(e.amount)},this}setCreationHeight(e,t){return(V(t)||t.replace===!0||t.replace===!1&&V(this._creationHeight))&&(this._creationHeight=e),this}setAdditionalRegisters(e){if(this._registers=bs(e),!_s(e))throw new jr;return this}eject(e){return e({tokens:this._tokens}),this}build(e){var n;let t=this.assets.toArray();if(this.minting){if(J(e))throw new Gr;J(this.additionalRegisters)&&this.setAdditionalRegisters({R4:gt(ft,ht.decode(this.minting.name||"")).toHex(),R5:gt(ft,ht.decode(this.minting.description||"")).toHex(),R6:gt(ft,ht.decode(((n=this.minting.decimals)==null?void 0:n.toString())||"0")).toHex()}),t=[{tokenId:we(e).boxId,amount:this.minting.amount},...t]}if(V(this.creationHeight))throw new Fr;return{value:this.value,ergoTree:this.ergoTree,creationHeight:this.creationHeight,assets:t.map(s=>({tokenId:s.tokenId,amount:s.amount})),additionalRegisters:this.additionalRegisters}}estimateSize(e=At){oe(!!this.creationHeight,"Creation height must be set");const t=this._tokens.toArray();this.minting&&t.push({tokenId:"0000000000000000000000000000000000000000000000000000000000000000",amount:this.minting.amount});const n={value:e,ergoTree:this.ergoTree,creationHeight:this.creationHeight,assets:t.map(s=>({tokenId:s.tokenId,amount:s.amount})),additionalRegisters:this.additionalRegisters};return Pr(n)}},li=class extends Error{constructor(e){super(e)}};function ui(e){return{addInputs:t=>e.from(t).configureSelector(n=>n.ensureInclusion(Array.isArray(t)?t.map(s=>s.boxId):t.boxId)).inputs.length,addOutputs:(t,n)=>e.to(t,n).outputs.length,addDataInputs:(t,n)=>e.withDataFrom(t,n).dataInputs.length,burnTokens:t=>{if(!e.settings.canBurnTokensFromPlugins)throw new Vn;e.burnTokens(t)},setFee:t=>e.payFee(t)}}var ci=class{constructor(){m(this,"_maxDistinctTokensPerChangeBox");m(this,"_allowTokenBurning");m(this,"_allowTokenBurningFromPlugins");m(this,"_isolateErgOnChange");this._maxDistinctTokensPerChangeBox=Bt,this._allowTokenBurning=!1,this._allowTokenBurningFromPlugins=!1,this._isolateErgOnChange=!1}get maxTokensPerChangeBox(){return this._maxDistinctTokensPerChangeBox}get canBurnTokens(){return this._allowTokenBurning}get canBurnTokensFromPlugins(){return this.canBurnTokens||this._allowTokenBurningFromPlugins}get shouldIsolateErgOnChange(){return this._isolateErgOnChange}setMaxTokensPerChangeBox(e){return this._maxDistinctTokensPerChangeBox=e,this}allowTokenBurning(e=!0){return this._allowTokenBurning=e,this}allowTokenBurningFromPlugins(e=!0){return this._allowTokenBurningFromPlugins=e,this}isolateErgOnChange(e=!0){return this._isolateErgOnChange=e,this}},Fn=BigInt(11e5),hi="1005040004000e36100204a00b08cd0279be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798ea02d192a39a8cc7a701730073011001020402d19683030193a38cc7b2a57300000193c2b2a57301007473027303830108cdeeac93b1a57304",di=class{constructor(e){m(this,"_inputs");m(this,"_dataInputs");m(this,"_outputs");m(this,"_settings");m(this,"_creationHeight");m(this,"_selectorCallbacks");m(this,"_changeAddress");m(this,"_feeAmount");m(this,"_burning");m(this,"_plugins");this._inputs=new Xt,this._dataInputs=new Xt,this._outputs=new ri,this._settings=new ci,this._creationHeight=e}get inputs(){return this._inputs}get dataInputs(){return this._dataInputs}get outputs(){return this._outputs}get changeAddress(){return this._changeAddress}get fee(){return this._feeAmount}get burning(){return this._burning}get settings(){return this._settings}get creationHeight(){return this._creationHeight}get and(){return this}from(e){return fi(e)&&(e=e.toArray()),this._inputs.add(e),this}to(e,t){return this._outputs.add(e,t),this}withDataFrom(e,t){return this._dataInputs.add(e,t),this}sendChangeTo(e){return typeof e=="string"?this._changeAddress=gn(e)?De.fromErgoTree(e,lt.Mainnet):De.fromBase58(e):this._changeAddress=e,this}payFee(e){return this._feeAmount=O(e),this}payMinFee(){return this.payFee(Fn),this}burnTokens(e){return this._burning||(this._burning=new Et),this._burning.add(e),this}configure(e){return e(this._settings),this}configureSelector(e){return V(this._selectorCallbacks)&&(this._selectorCallbacks=[]),this._selectorCallbacks.push(e),this}extend(e){return this._plugins||(this._plugins=[]),this._plugins.push({execute:e,pending:!0}),this}eject(e){return e({inputs:this.inputs,dataInputs:this.dataInputs,outputs:this.outputs,burning:this.burning,settings:this.settings,selection:t=>{this.configureSelector(t)}}),this}build(){if(z(this._plugins)){const o=ui(this);for(const a of this._plugins)a.pending&&(a.execute(o),a.pending=!1)}if(this._isMinting()){if(this._isMoreThanOneTokenBeingMinted())throw new Kt("only one token can be minted per transaction.");if(this._isTheSameTokenBeingMintedOutsideTheMintingBox())throw new li("EIP-4 tokens cannot be minted from outside of the minting box.")}this.outputs.toArray().map(o=>o.setCreationHeight(this._creationHeight,{replace:!1}));const e=this.outputs.clone();k(this._feeAmount)&&e.add(new Re(this._feeAmount,hi));const t=new $r(this.inputs.toArray());if(z(this._selectorCallbacks))for(const o of this._selectorCallbacks)o(t);const n=z(this._burning)?e.sum({tokens:this._burning.toArray()}):e.sum();let s=t.select(n);if(k(this._changeAddress)){let o=Je(he(s),n);const a=[];if(z(o.tokens)){let l=qt({changeAddress:this._changeAddress,creationHeight:this._creationHeight,tokens:o.tokens,maxTokensPerBox:this.settings.maxTokensPerChangeBox,baseIndex:this.outputs.length+1});for(;l>o.nanoErgs;)s=t.select({nanoErgs:n.nanoErgs+l,tokens:n.tokens}),o=Je(he(s),n),l=qt({changeAddress:this._changeAddress,creationHeight:this._creationHeight,tokens:o.tokens,maxTokensPerBox:this.settings.maxTokensPerChangeBox,baseIndex:this.outputs.length+1});const c=hs(o.tokens,this._settings.maxTokensPerChangeBox);for(const f of c){const u=new Re(ai(),this._changeAddress,this._creationHeight).addTokens(f);o.nanoErgs-=u.value,a.push(u)}}if(o.nanoErgs>E)if(z(a)){if(this.settings.shouldIsolateErgOnChange)e.add(new Re(o.nanoErgs,this._changeAddress));else{const l=we(a);l.setValue(l.value+o.nanoErgs)}e.add(a)}else e.add(new Re(o.nanoErgs,this._changeAddress))}for(const o of s)if(!o.isValid())throw new ni(o.boxId);const r=new Zr(s,this.dataInputs.toArray(),e.toArray().map(o=>o.setCreationHeight(this._creationHeight,{replace:!1}).build(s)));let i=r.burning;if(i.nanoErgs>E)throw new Kt("it's not possible to burn ERG.");if(z(i.tokens)&&z(this._burning)&&(i=Je(i,{nanoErgs:E,tokens:this._burning.toArray()})),!this._settings.canBurnTokens&&z(i.tokens))throw new Vn;return r}_isMinting(){for(const e of this._outputs)if(e.minting)return!0;return!1}_isMoreThanOneTokenBeingMinted(){let e=0;for(const t of this._outputs)if(k(t.minting)&&(e++,e>1))return!0;return!1}_isTheSameTokenBeingMintedOutsideTheMintingBox(){const e=this._getMintingTokenId();if(V(e))return!1;for(const t of this._outputs)if(t.assets.contains(e))return!0;return!1}_getMintingTokenId(){let e;for(const t of this._outputs)if(t.minting){e=t.minting.tokenId;break}return e}};function fi(e){return e.toArray!==void 0}function qt(e){return BigInt(gi(e))*jn}function gi({changeAddress:e,creationHeight:t,tokens:n,baseIndex:s,maxTokensPerBox:r}){const i=Math.ceil(n.length/r);let o=0;o+=$(At),o+=Me(e.ergoTree),o+=$(t),o+=$(0),o+=32,o=o*i;for(let a=0;a<i;a++)o+=$(s+a);return o+=n.reduce((a,l)=>a+=Me(l.tokenId)+$(l.amount),0),n.length>r?n.length%r>0?(o+=$(r)*Math.floor(n.length/r),o+=$(n.length%r)):o+=$(r)*i:o+=$(n.length),o}function Wt(e){let t,n,s='Token amount<span class="required">*</span>',r,i,o,a;return{c(){t=w("div"),n=w("label"),n.innerHTML=s,r=M(),i=w("input"),this.h()},l(l){t=v(l,"DIV",{class:!0});var c=G(t);n=v(c,"LABEL",{for:!0,class:!0,"data-svelte-h":!0}),Z(n)!=="svelte-11094ei"&&(n.innerHTML=s),r=N(c),i=v(c,"INPUT",{type:!0,class:!0}),c.forEach(I),this.h()},h(){x(n,"for","reputationToken"),x(n,"class","form-label"),x(i,"type","number"),x(i,"class","form-control"),x(t,"class","mb-3")},m(l,c){K(l,t,c),y(t,n),y(t,r),y(t,i),ie(i,e[3]),o||(a=Y(i,"input",e[11]),o=!0)},p(l,c){c&8&&rt(i.value)!==l[3]&&ie(i,l[3])},d(l){l&&I(t),o=!1,a()}}}function Yt(e){let t,n,s="Reputation proof",r,i,o,a,l,c,f,u='Token amount<span class="required">*</span>',g,p,b,_;return{c(){t=w("div"),n=w("label"),n.textContent=s,r=M(),i=w("select"),o=Yn(`' +
						  `),a=w("option"),l=M(),c=w("div"),f=w("label"),f.innerHTML=u,g=M(),p=w("input"),this.h()},l(T){t=v(T,"DIV",{class:!0});var B=G(t);n=v(B,"LABEL",{class:!0,"data-svelte-h":!0}),Z(n)!=="svelte-jndwld"&&(n.textContent=s),r=N(B),i=v(B,"SELECT",{class:!0});var fe=G(i);o=Zn(fe,`' +
						  `),a=v(fe,"OPTION",{}),G(a).forEach(I),fe.forEach(I),B.forEach(I),l=N(T),c=v(T,"DIV",{class:!0});var ee=G(c);f=v(ee,"LABEL",{for:!0,class:!0,"data-svelte-h":!0}),Z(f)!=="svelte-11094ei"&&(f.innerHTML=u),g=N(ee),p=v(ee,"INPUT",{type:!0,class:!0,max:!0}),ee.forEach(I),this.h()},h(){x(n,"class","form-label"),a.__value="",ie(a,a.__value),x(i,"class","form-select"),e[5]===void 0&&rn(()=>e[12].call(i)),x(t,"class","mb-3"),x(f,"for","reputationToken"),x(f,"class","form-label"),x(p,"type","number"),x(p,"class","form-control"),x(p,"max",e[8]),x(c,"class","mb-3")},m(T,B){K(T,t,B),y(t,n),y(t,r),y(t,i),y(i,o),y(i,a),st(i,e[5],!0),K(T,l,B),K(T,c,B),y(c,f),y(c,g),y(c,p),ie(p,e[3]),b||(_=[Y(i,"change",e[12]),Y(p,"input",e[13])],b=!0)},p(T,B){B&32&&st(i,T[5]),B&8&&rt(p.value)!==T[3]&&ie(p,T[3])},d(T){T&&(I(t),I(l),I(c)),b=!1,on(_)}}}function Zt(e){let t,n,s="Object to assign reputation",r,i,o,a;return{c(){t=w("div"),n=w("label"),n.textContent=s,r=M(),i=w("input"),this.h()},l(l){t=v(l,"DIV",{class:!0});var c=G(t);n=v(c,"LABEL",{for:!0,class:!0,"data-svelte-h":!0}),Z(n)!=="svelte-1qqq00c"&&(n.textContent=s),r=N(c),i=v(c,"INPUT",{type:!0,class:!0}),c.forEach(I),this.h()},h(){x(n,"for","reputationRegister"),x(n,"class","form-label"),x(i,"type","text"),x(i,"class","form-control"),x(t,"class","mb-3")},m(l,c){K(l,t,c),y(t,n),y(t,r),y(t,i),ie(i,e[4]),o||(a=Y(i,"input",e[14]),o=!0)},p(l,c){c&16&&i.value!==l[4]&&ie(i,l[4])},d(l){l&&I(t),o=!1,a()}}}function pi(e){let t,n,s,r="Generate new reputation proof",i,o,a,l,c,f,u="Choose an option",g,p,b,_,T="A new one",B,fe="From another reputation prove",ee,F,Be,H,Ae,Ee,ge,ae,X,Oe="Generate proof",Pe,Ge,P=e[2]==="new"&&Wt(e),L=e[2]==="another"&&Yt(e),U=e[2]!==""&&Zt(e);return{c(){t=w("dialog"),n=w("div"),s=w("h2"),s.textContent=r,i=M(),o=w("hr"),a=M(),l=w("form"),c=w("div"),f=w("label"),f.textContent=u,g=M(),p=w("select"),b=w("option"),_=w("option"),_.textContent=T,B=w("option"),B.textContent=fe,ee=M(),F=w("div"),P&&P.c(),Be=M(),L&&L.c(),H=M(),U&&U.c(),Ae=M(),Ee=w("hr"),ge=M(),ae=w("div"),X=w("button"),X.textContent=Oe,this.h()},l(R){t=v(R,"DIALOG",{class:!0});var le=G(t);n=v(le,"DIV",{class:!0});var te=G(n);s=v(te,"H2",{class:!0,id:!0,"data-svelte-h":!0}),Z(s)!=="svelte-dvmzlv"&&(s.textContent=r),i=N(te),o=v(te,"HR",{}),a=N(te),l=v(te,"FORM",{id:!0});var Qe=G(l);c=v(Qe,"DIV",{class:!0});var Ke=G(c);f=v(Ke,"LABEL",{class:!0,"data-svelte-h":!0}),Z(f)!=="svelte-bl1561"&&(f.textContent=u),g=N(Ke),p=v(Ke,"SELECT",{class:!0});var Xe=G(p);b=v(Xe,"OPTION",{}),G(b).forEach(I),_=v(Xe,"OPTION",{"data-svelte-h":!0}),Z(_)!=="svelte-11rr8kj"&&(_.textContent=T),B=v(Xe,"OPTION",{"data-svelte-h":!0}),Z(B)!=="svelte-wg52qh"&&(B.textContent=fe),Xe.forEach(I),Ke.forEach(I),ee=N(Qe),F=v(Qe,"DIV",{});var Ce=G(F);P&&P.l(Ce),Be=N(Ce),L&&L.l(Ce),H=N(Ce),U&&U.l(Ce),Ce.forEach(I),Qe.forEach(I),Ae=N(te),Ee=v(te,"HR",{}),ge=N(te),ae=v(te,"DIV",{class:!0});var Ct=G(ae);X=v(Ct,"BUTTON",{class:!0,"data-svelte-h":!0}),Z(X)!=="svelte-1h0ubc8"&&(X.textContent=Oe),Ct.forEach(I),te.forEach(I),le.forEach(I),this.h()},h(){x(s,"class","modal-title"),x(s,"id","generateReputationLabel"),x(f,"class","form-label"),b.__value="",ie(b,b.__value),_.__value="new",ie(_,_.__value),B.__value="another",ie(B,B.__value),x(p,"class","form-select"),e[2]===void 0&&rn(()=>e[10].call(p)),x(c,"class","mb-3"),x(l,"id","reputationForm"),x(X,"class","svelte-19dligb"),x(ae,"class","row"),x(n,"class","svelte-19dligb"),x(t,"class","svelte-19dligb")},m(R,le){K(R,t,le),y(t,n),y(n,s),y(n,i),y(n,o),y(n,a),y(n,l),y(l,c),y(c,f),y(c,g),y(c,p),y(p,b),y(p,_),y(p,B),st(p,e[2],!0),y(l,ee),y(l,F),P&&P.m(F,null),y(F,Be),L&&L.m(F,null),y(F,H),U&&U.m(F,null),y(n,Ae),y(n,Ee),y(n,ge),y(n,ae),y(ae,X),e[16](t),Pe||(Ge=[Y(p,"change",e[10]),Y(p,"change",e[7]),Y(X,"click",e[15]),Y(n,"click",qn(e[9])),Y(t,"close",e[17]),Y(t,"click",Wn(e[18]))],Pe=!0)},p(R,[le]){le&4&&st(p,R[2]),R[2]==="new"?P?P.p(R,le):(P=Wt(R),P.c(),P.m(F,Be)):P&&(P.d(1),P=null),R[2]==="another"?L?L.p(R,le):(L=Yt(R),L.c(),L.m(F,H)):L&&(L.d(1),L=null),R[2]!==""?U?U.p(R,le):(U=Zt(R),U.c(),U.m(F,null)):U&&(U.d(1),U=null)},i:Ht,o:Ht,d(R){R&&I(t),P&&P.d(),L&&L.d(),U&&U.d(),e[16](null),Pe=!1,on(Ge)}}}function mi(e,t,n){async function s(H,Ae,Ee){console.log("new one ",H,"   token id ",Ae,"   token_amount",Ee);const ge=await ergo.get_change_address(),ae=ge+ergo.get_current_height().toString(),X=new Re(At,ge);H?X.mintToken({amount:Ee,name:"rt-"+ae,decimals:0,description:"Reputation token "+ae+" of the wallet "+ge}):X.addTokens({tokenId:Ae,amount:Ee},{sum:!1});const Oe=await new di(await ergo.get_current_height()).from(await ergo.get_utxos()).to(X).sendChangeTo(ge).payFee(Fn).build().toEIP12Object();console.log(Oe);const Pe=await ergo.sign_tx(Oe),Ge=await ergo.submit_tx(Pe);console.log("transaction id -> ",Ge)}let{showModal:r}=t,i,o="";function a(H){n(2,o=H.target.value)}let l,c,f,u;function g(H){Kn.call(this,e,H)}function p(){o=Ot(this),n(2,o)}function b(){l=rt(this.value),n(3,l)}function _(){f=Ot(this),n(5,f)}function T(){l=rt(this.value),n(3,l)}function B(){c=this.value,n(4,c)}const fe=()=>s(o==="new",f,l);function ee(H){an[H?"unshift":"push"](()=>{i=H,n(1,i)})}const F=()=>n(0,r=!1),Be=()=>i.close();return e.$$set=H=>{"showModal"in H&&n(0,r=H.showModal)},e.$$.update=()=>{e.$$.dirty&3&&i&&r&&i.showModal()},[r,i,o,l,c,f,s,a,u,g,p,b,_,T,B,fe,ee,F,Be]}class _i extends ln{constructor(t){super(),un(this,t,mi,pi,sn,{showModal:0})}}function Jt(e){let t,n="Generate reputation proof",s,r,i,o,a,l;function c(u){e[4](u)}let f={};return e[0]!==void 0&&(f.showModal=e[0]),r=new _i({props:f}),an.push(()=>es(r,"showModal",c)),{c(){t=w("button"),t.textContent=n,s=M(),ts(r.$$.fragment)},l(u){t=v(u,"BUTTON",{"data-svelte-h":!0}),Z(t)!=="svelte-179w2h4"&&(t.textContent=n),s=N(u),ns(r.$$.fragment,u)},m(u,g){K(u,t,g),K(u,s,g),ss(r,u,g),o=!0,a||(l=Y(t,"click",e[3]),a=!0)},p(u,g){const p={};!i&&g&1&&(i=!0,p.showModal=u[0],Xn(()=>i=!1)),r.$set(p)},i(u){o||(Ze(r.$$.fragment,u),o=!0)},o(u){mt(r.$$.fragment,u),o=!1},d(u){u&&(I(t),I(s)),rs(r,u),a=!1,l()}}}function bi(e){let t,n="Welcome to the Reputation System Panel",s,r,i="Connect to Nautilus",o,a,l,c,f,u=e[1]&&Jt(e);return{c(){t=w("h1"),t.textContent=n,s=M(),r=w("button"),r.textContent=i,o=M(),u&&u.c(),a=Pt()},l(g){t=v(g,"H1",{"data-svelte-h":!0}),Z(t)!=="svelte-1rnm7g8"&&(t.textContent=n),s=N(g),r=v(g,"BUTTON",{"data-svelte-h":!0}),Z(r)!=="svelte-dso3br"&&(r.textContent=i),o=N(g),u&&u.l(g),a=Pt()},m(g,p){K(g,t,p),K(g,s,p),K(g,r,p),K(g,o,p),u&&u.m(g,p),K(g,a,p),l=!0,c||(f=Y(r,"click",e[2]),c=!0)},p(g,[p]){g[1]?u?(u.p(g,p),p&2&&Ze(u,1)):(u=Jt(g),u.c(),Ze(u,1),u.m(a.parentNode,a)):u&&(is(),mt(u,1,1,()=>{u=null}),Jn())},i(g){l||(Ze(u),l=!0)},o(g){mt(u),l=!1},d(g){g&&(I(t),I(s),I(r),I(o),I(a)),u&&u.d(g),c=!1,f()}}}function yi(e,t,n){let s=!1,r=!1;async function i(){if(ergoConnector){const l=ergoConnector.nautilus;l?(console.log("Nautilus Wallet is ready to use"),n(1,r=await l.connect()),console.log(r?"Connected!":"Not connected!")):console.log("Nautilus Wallet is not active")}else console.log("No wallet available")}const o=()=>n(0,s=!0);function a(l){s=l,n(0,s)}return[s,r,i,o,a]}class xi extends ln{constructor(t){super(),un(this,t,yi,bi,sn,{})}}export{xi as component};
